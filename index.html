<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ SK ë©˜í†  ê°€ì´ë“œ</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#EA4335">
    
    <!-- CSS íŒŒì¼ ë§í¬ -->
    <link rel="stylesheet" href="assets/css/main-v2.1.css">  
</head>

<body>
    <!-- ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ ê¶Œí•œ ìš”ì²­ ë°°ë„ˆ -->
    <div class="notification-permission-banner" id="notificationBanner">
        <div class="permission-icon">ğŸ””</div>
        <div class="permission-content">
            <div class="permission-title">ì‹¤ì‹œê°„ ì•Œë¦¼ ì„¤ì •</div>
            <div class="permission-text">ì¤‘ìš”í•œ ì—…ë¬´ ì•Œë¦¼ì„ ë†“ì¹˜ì§€ ì•Šë„ë¡ ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ì„ í™œì„±í™”í•˜ì„¸ìš”</div>
        </div>
        <div class="permission-actions">
            <button class="permission-btn" onclick="hideNotificationBanner()">ë‚˜ì¤‘ì—</button>
            <button class="permission-btn primary" onclick="requestMobilePushPermission()">ì„¤ì •í•˜ê¸°</button>
        </div>
        <!-- X ë‹«ê¸° ë²„íŠ¼ ì¶”ê°€ -->
        <button class="permission-close" onclick="hideNotificationBanner()">Ã—</button>
    </div>

    <!-- Header -->
        <div class="header">
            <h1>ğŸ¯ ìŠ¬ê¸°ë¡œìš´ ë©˜í†  ìƒí™œ ê°€ì´ë“œ</h1>
            <div class="subtitle" id="headerSubtitle">2025ë…„ 7ì›” SKê·¸ë£¹ ì‹ ì…êµ¬ì„±ì›ê³¼ì •</div>
        </div>

    <div class="container">     
        <!-- Today's Essential Tasks -->
        <div class="section daily-tasks-section">
            <h2>ğŸ“Š ì˜¤ëŠ˜ì˜ í•  ì¼</h2>
            <p class="section-description">ìš°ë¦¬ ë¶„ê³¼ ì¶œì„ í˜„í™©ì„ í™•ì¸í•˜ê³  ë“±ë¡í•˜ì„¸ìš”</p>
            
            <div class="tasks-grid">
                <!-- ì¶œì„ì²´í¬ - ì˜¤ì „ -->
                <div class="task-card attendance-morning" id="morningTask">
                    <div class="task-header">
                        <div class="task-title">
                            ğŸŒ… ì˜¤ì „ ì¶œì„ì²´í¬
                        </div>
                        <div class="task-status status-pending" id="morningStatus">ëŒ€ê¸°ì¤‘</div>
                    </div>
                    
                    <div class="task-progress">
                        <div class="task-progress-bar" style="width: 0%" id="morningProgress"></div>
                    </div>
                    
                    <div class="task-details">
                        <strong>ì˜¤ì „ 9ì‹œ ê¸°ì¤€ ì¶œì„ í˜„í™© ì œì¶œ</strong><br>
                        <small class="task-deadline">â° ë§ˆê°: ì˜¤ì „ 9:30</small>
                    </div>
                    
                    <div class="task-actions">
                        <!-- ì˜¤ì „ ì¶œì„ì²´í¬ ì¹´ë“œì˜ ë²„íŠ¼ -->
                        <a href="guides/attendance.html?time=morning" class="task-button btn-primary">ğŸ“‹ ì¶œì„ì²´í¬ í•˜ê¸°</a>
                    </div>
                </div>

                <!-- ì¶œì„ì²´í¬ - ì˜¤í›„ -->
                <div class="task-card attendance-afternoon" id="afternoonTask">
                    <div class="task-header">
                        <div class="task-title">
                            ğŸŒ ì˜¤í›„ ì¶œì„ì²´í¬
                        </div>
                        <div class="task-status status-pending" id="afternoonStatus">ëŒ€ê¸°ì¤‘</div>
                    </div>
                    
                    <div class="task-progress">
                        <div class="task-progress-bar" style="width: 0%" id="afternoonProgress"></div>
                    </div>
                    
                    <div class="task-details">
                        <strong>ì˜¤í›„ 2ì‹œ ê¸°ì¤€ ì¶œì„ í˜„í™© ì œì¶œ</strong><br>
                        <small class="task-deadline">â° ë§ˆê°: ì˜¤í›„ 2:30</small>
                    </div>
                    
                    <div class="task-actions">
                        <!-- ì˜¤í›„ ì¶œì„ì²´í¬ ì¹´ë“œì˜ ë²„íŠ¼ -->  
                        <a href="guides/attendance.html?time=afternoon" class="task-button btn-primary">ğŸ“‹ ì¶œì„ì²´í¬ í•˜ê¸°</a>
                    </div>
                </div>

                <!-- 1:1 ë©´ë‹´ -->
                <div class="task-card interview-card" id="interviewTask">
                    <div class="task-header">
                        <div class="task-title">
                            ğŸ’¬ 1:1 ë©´ë‹´ ì§„í–‰ í˜„í™©
                        </div>
                        <div class="task-status status-partial" id="interviewStatus">ì§„í–‰ì¤‘</div>
                    </div>
                    
                    <div class="interview-stats">
                        <div class="stat-item">
                            <div class="stat-number" id="totalMentees">0</div>
                            <div class="stat-label">ì´ ë©˜í‹°</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="completedInterviews">0</div>
                            <div class="stat-label">ì™„ë£Œ</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="pendingInterviews">0</div>
                            <div class="stat-label">ëŒ€ê¸°</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="interviewProgress">0%</div>
                            <div class="stat-label">ì§„í–‰ë¥ </div>
                        </div>
                    </div>
                    
                    <div class="task-progress">
                        <div class="task-progress-bar" style="width: 0%" id="totalInterviewProgress"></div>
                    </div>
                    
                    <div class="task-details">
                        <strong>ë©˜í‹°ë³„ 1:1 ë©´ë‹´ ì‹¤ì‹œ ë° ë‚´ìš© ì œì¶œ</strong><br>
                        <small class="task-deadline">ğŸ’¡ ë©´ë‹´ í›„ ì¦‰ì‹œ ë‚´ìš©ì„ ê¸°ë¡í•´ì£¼ì„¸ìš”</small>
                        <div class="interview-details" id="interviewDetails"></div>
                    </div>
                    
                    <div class="task-actions">
                        <a href="guides/interview.html" class="task-button btn-primary">ğŸ’¬ ë©´ë‹´ ê¸°ë¡í•˜ê¸°</a>
                        <button class="task-button btn-secondary" onclick="viewInterviewHistory()">ğŸ“Š ë©´ë‹´ ê¸°ë¡ ë³´ê¸°</button>
                    </div>
                </div>
            </div>

            <!-- ë°ì¼ë¦¬ íƒœìŠ¤í¬ ìš”ì•½ -->
            <div class="daily-summary" id="dailySummary">
                <div class="summary-item">
                    <span class="summary-icon">ğŸ“‹</span>
                    <div class="summary-content">
                        <div class="summary-title">ì¶œì„ì²´í¬</div>
                        <div class="summary-status" id="attendanceSummary">ì˜¤ì „Â·ì˜¤í›„ ëŒ€ê¸°ì¤‘</div>
                    </div>
                </div>
                <div class="summary-item">
                    <span class="summary-icon">ğŸ’¬</span>
                    <div class="summary-content">
                        <div class="summary-title">1:1 ë©´ë‹´</div>
                        <div class="summary-status" id="interviewSummary">ì„¤ì • í•„ìš”</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Today's Schedule - Google Sheets ì™„ì „ ì—°ë™ ë²„ì „ -->
<div class="section schedule-section">
    <div class="schedule-header">
        <h2>ğŸ“… ì˜¤ëŠ˜ì˜ ì¼ì •</h2>
        <div class="schedule-actions">
            <button class="btn-refresh-schedule" onclick="refreshTodaySchedule()">
                ğŸ”„ ìƒˆë¡œê³ ì¹¨
            </button>
            <button class="btn-full-schedule" onclick="showDynamicFullTimetable()">
                ğŸ“‹ ì „ì²´ ì¼ì • ë³´ê¸°
            </button>
        </div>
    </div>
    
    <div class="schedule-today">
        <div class="today-date" id="today-date">
            <!-- JavaScriptê°€ ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ìë™ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤ -->
        </div>
        
        <div id="schedule-content">
            <!-- Google Sheets ë°ì´í„°ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
            <div class="schedule-loading">
                <div class="loading-spinner"></div>
                <p>ì¼ì •ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
            </div>
        </div>
    </div>
</div>

<!-- ë™ì  ì „ì²´ ì¼ì • ëª¨ë‹¬ -->
<div class="full-timetable-modal" id="dynamicTimetableModal" style="display: none;">
    <div class="modal-backdrop" onclick="closeDynamicTimetable()"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTitle">ğŸ“… ì „ì²´ ì¼ì •</h2>
            <button class="modal-close" onclick="closeDynamicTimetable()">Ã—</button>
        </div>
        
        <div class="modal-filters">
            <select id="weekFilter" onchange="filterTimetableByWeek()">
                <option value="all">ì „ì²´ ì£¼ì°¨</option>
            </select>
            <select id="dayFilter" onchange="filterTimetableByDay()">
                <option value="all">ì „ì²´ ìš”ì¼</option>
                <option value="monday">ì›”ìš”ì¼</option>
                <option value="tuesday">í™”ìš”ì¼</option>
                <option value="wednesday">ìˆ˜ìš”ì¼</option>
                <option value="thursday">ëª©ìš”ì¼</option>
                <option value="friday">ê¸ˆìš”ì¼</option>
            </select>
        </div>
        
        <div class="timetable-container" id="dynamicTimetableContainer">
            <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ì „ì²´ ì¼ì • -->
        </div>
        
        <div class="modal-footer">
            <div class="schedule-legend">
                <div class="legend-item">
                    <div class="legend-color mentor"></div>
                    <span>ë©˜í†  ì§„í–‰/í•„ìˆ˜ì°¸ê´€</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color optional"></div>
                    <span>ì„ íƒì°¸ê´€</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color break"></div>
                    <span>íœ´ì‹ì‹œê°„</span>
                </div>
            </div>
            <div class="data-info" id="dataLastUpdated">
                <!-- ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ì‹œê°„ í‘œì‹œ -->
            </div>
        </div>
    </div>
</div>

<!-- Today's Mentor Program -->
<div class="section mentor-program-section">
    <h2>ğŸ¯ ì˜¤ëŠ˜ì˜ ë©˜í†  í”„ë¡œê·¸ë¨</h2>
    
    <div id="mentor-program-card" class="mentor-programs-container">
        <!-- 1-2ê°œì˜ ë©˜í†  í”„ë¡œê·¸ë¨ ì¹´ë“œê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
    </div>
</div>

<!-- Quick Access to Program Guides -->
<div id="guide-section" class="section quick-access-section">
    <h2>ğŸ§­ í”„ë¡œê·¸ë¨ë³„ ê°€ì´ë“œ</h2>
    <div class="program-grid">
        <!-- 1. Daily Opening -->
        <a href="guides/daily-opening.html" class="program-card daily">
            <div class="program-card-header">
                <div class="program-icon">ğŸŒ…</div>
                <h3>Daily Opening</h3>
            </div>
            <p>ë§¤ì¼ í•˜ëŠ” ê²ƒë“¤ ì§„í–‰ë²•<br>ì¶œê²° ì²´í¬, Biz. Manner, ì•ˆë‚´ì‚¬í•­</p>
        </a>

        <!-- 2. Vision Building -->
        <a href="guides/vision-building.html" class="program-card vision">
            <div class="program-card-header">
                <div class="program-icon">ğŸ¯</div>
                <h3>Vision Building</h3>
            </div>
            <p>ìê¸°ì†Œê°œ & íŒ€ë¹Œë”© í™œë™ ì™„ì „ ê°€ì´ë“œ<br>ì§„í–‰ ìˆœì„œ, ì§ˆë¬¸ ë‚´ìš©, ì‹œê°„ ë°°ë¶„</p>
        </a>

        <!-- 3. Play SKMS -->
        <a href="guides/play-skms.html" class="program-card play">
            <div class="program-card-header">
                <div class="program-icon">ğŸ®</div>
                <h3>Play SKMS</h3>
            </div>
            <p>SKMS ê²Œì„ ê´€ì°° í¬ì¸íŠ¸<br>VWBE í–‰ë™ ë°œê²¬, í”¼ë“œë°± ë°©ë²•</p>
        </a>

        <!-- 4. ê¸°ë…ê´€ Tour -->
        <a href="guides/memorial-tour.html" class="program-card memorial">
            <div class="program-card-header">
                <div class="program-icon">ğŸ›ï¸</div>
                <h3>ê¸°ë…ê´€ Tour</h3>
            </div>
            <p>ìŠ¤í† ë¦¬í…”ë§ ìŠ¤í¬ë¦½íŠ¸ & í•µì‹¬ í¬ì¸íŠ¸<br>ì¸µë³„ ê°€ì´ë“œ, ê°ë™ í¬ì¸íŠ¸, íƒ€ì´ë°</p>
        </a>

        <!-- 5. ì„±ì¥ Roadmap -->
        <a href="guides/growth-roadmap.html" class="program-card roadmap">
            <div class="program-card-header">
                <div class="program-icon">ğŸ“ˆ</div>
                <h3>ì„±ì¥ Roadmap</h3>
            </div>
            <p>ê°•ì  ì§„ë‹¨ ê¸°ë°˜ ë¡œë“œë§µ ì‘ì„±ë²•<br>ê°€ì´ë“œ ë°©ë²•, ì§ˆë¬¸ ê¸°ë²•</p>
        </a>

        <!-- 6. 1:1 ë©´ë‹´ -->
        <a href="guides/interview.html" class="program-card interview">
            <div class="program-card-header">
                <div class="program-icon">ğŸ’¬</div>
                <h3>1:1 ë©´ë‹´</h3>
            </div>
            <p>ì§ˆë¬¸ ì˜ˆì‹œ & ìƒí™©ë³„ ëŒ€ì‘ë²•<br>ë©´ë‹´ ê¸°ë²•, ëŒë°œ ìƒí™© ëŒ€ì²˜</p>
        </a>
    </div>
</div>

<!-- Quick Actions -->
<div class="section quick-actions-section">
    <h2>âš¡ ë¹ ë¥¸ ì‘ì—…</h2>
    <div class="quick-actions">
        <button class="quick-action" onclick="quickAttendance()">
            <div class="quick-action-icon">ğŸ“‹</div>
            <div class="quick-action-title">ê¸´ê¸‰ ì¶œì„ì²´í¬</div>
            <div class="quick-action-desc">ë¹ ë¥¸ ì¶œì„ í˜„í™© ì œì¶œ</div>
        </button>
        
        <button class="quick-action" onclick="quickInterview()">
            <div class="quick-action-icon">ğŸ’¬</div>
            <div class="quick-action-title">ë©´ë‹´ ê¸°ë¡</div>
            <div class="quick-action-desc">1:1 ë©´ë‹´ ë‚´ìš© ì œì¶œ</div>
        </button>
        
        <button class="quick-action" onclick="viewSubmissions()">
            <div class="quick-action-icon">ğŸ“„</div>
            <div class="quick-action-title">ì œì¶œ ë‚´ì—­</div>
            <div class="quick-action-desc">ì§€ë‚œ ì œì¶œ ê¸°ë¡ í™•ì¸</div>
        </button>
        
        <button class="quick-action" onclick="showMentorInfo()" id="mentorInfoAction">
            <div class="quick-action-icon">ğŸ‘¤</div>
            <div class="quick-action-title">ë©˜í†  ì •ë³´</div>
            <div class="quick-action-desc" id="mentorInfoDesc">ì„¤ì • í•„ìš”</div>
        </button>
    </div>
</div>

<!-- Mentor Core Principles -->
<div class="section principles-section">
    <h2>ğŸ’¡ ë©˜í†  í•µì‹¬ ì›ì¹™</h2>
    <div class="principle-item">
        <div class="principle-number">1</div>
        <div class="principle-text">ë¯¸ì†Œì™€ ì—¬ìœ ë¥¼ ìƒì§€ ì•Šê¸° - ê¸ì •ì  ë¶„ìœ„ê¸° ì¡°ì„±</div>
    </div>
    <div class="principle-item">
        <div class="principle-number">2</div>
        <div class="principle-text">ëª¨ë“  ë©˜í‹°ì—ê²Œ ê´€ì‹¬ ê°–ê¸° - ì†Œì™¸ë˜ëŠ” êµ¬ì„±ì› ì—†ì´</div>
    </div>
    <div class="principle-item">
        <div class="principle-number">3</div>
        <div class="principle-text">ì•ˆì „ ìµœìš°ì„ ìœ¼ë¡œ í–‰ë™í•˜ê¸° - ì˜ˆë°©ì´ ìµœì„ ì˜ ëŒ€ì²˜</div>
    </div>
</div>
   
    </div>

    <!-- ì•Œë¦¼ ì‹œìŠ¤í…œ -->
    <div class="notifications" id="notifications"></div>

    <!-- ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ ìƒíƒœ í‘œì‹œ -->
    <div class="notification-status" id="notificationStatus">
        ì•Œë¦¼ ìƒíƒœ: í™•ì¸ ì¤‘...
    </div>

    <!-- ë©˜í†  ì„¤ì • ëª¨ë‹¬ -->
    <div class="mentor-setup-modal" id="mentorSetupModal" style="display: none;">
        <!-- ëª¨ë‹¬ ë‚´ìš©ì€ JavaScriptë¡œ ë™ì  ìƒì„± -->
    </div>

    <!-- JavaScript íŒŒì¼ ë§í¬ -->
    <script src="assets/js/app.js"></script>
    <script src="assets/js/utils.js"></script>

    <script>
        // =================================================================
        // ë©˜í†  ì •ë³´ ë° ë¶„ê³¼ë³„ í˜„í™© ê´€ë¦¬ ì‹œìŠ¤í…œ
        // =================================================================
        
        class MentorTeamManager {
            constructor() {
                this.mentorInfo = this.loadMentorInfo();
                this.init();
            }

            // ë©˜í†  ì •ë³´ ë¡œë“œ
            loadMentorInfo() {
                const stored = localStorage.getItem('sk-mentor-info');
                if (stored) {
                    return JSON.parse(stored);
                }
                return null;
            }

            // ì´ˆê¸°í™”
            init() {
                if (!this.mentorInfo) {
                    this.showMentorSetupPrompt();
                } else {
                    this.updateDashboard();
                }
            }

            // ë©˜í†  ì„¤ì • ì•ˆë‚´ í‘œì‹œ
            showMentorSetupPrompt() {
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.7);
                    z-index: 10000;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    padding: 20px;
                `;
                
                modal.innerHTML = `
                    <div style="
                        background: white;
                        border-radius: 16px;
                        padding: 24px;
                        max-width: 400px;
                        width: 100%;
                        text-align: center;
                        box-shadow: 0 20px 40px rgba(0,0,0,0.3);
                    ">
                        <h2 style="color: #1976d2; margin-bottom: 16px;">ğŸ¯ ë©˜í†  ì •ë³´ ì„¤ì • í•„ìš”</h2>
                        <p style="color: #666; margin-bottom: 24px; line-height: 1.5;">
                            ë¶„ê³¼ë³„ í˜„í™© ê´€ë¦¬ë¥¼ ìœ„í•´<br>
                            ë©˜í†  ì •ë³´ë¥¼ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”.
                        </p>
                        <button onclick="mentorTeamManager.showMentorSetupForm()" 
                                style="
                                    background: #1976d2;
                                    color: white;
                                    border: none;
                                    padding: 12px 24px;
                                    border-radius: 8px;
                                    font-weight: 600;
                                    cursor: pointer;
                                    margin-right: 8px;
                                ">
                            ì§€ê¸ˆ ì„¤ì •í•˜ê¸°
                        </button>
                        <button onclick="this.parentElement.parentElement.remove()" 
                                style="
                                    background: #f5f5f5;
                                    color: #666;
                                    border: none;
                                    padding: 12px 24px;
                                    border-radius: 8px;
                                    cursor: pointer;
                                ">
                            ë‚˜ì¤‘ì—
                        </button>
                    </div>
                `;
                
                document.body.appendChild(modal);
            }

            // ë©˜í†  ì„¤ì • í¼ í‘œì‹œ
            showMentorSetupForm() {
                // ê¸°ì¡´ ëª¨ë‹¬ ì œê±°
                const existingModal = document.querySelector('div[style*="position: fixed"]');
                if (existingModal) {
                    existingModal.remove();
                }

                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.8);
                    z-index: 10000;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    padding: 20px;
                    overflow-y: auto;
                `;
                
                modal.innerHTML = `
                    <div style="
                        background: white;
                        border-radius: 16px;
                        padding: 32px;
                        max-width: 500px;
                        width: 100%;
                        max-height: 90vh;
                        overflow-y: auto;
                        box-shadow: 0 20px 40px rgba(0,0,0,0.3);
                    ">
                        <div style="text-align: center; margin-bottom: 24px;">
                            <h2 style="color: #1976d2; margin-bottom: 8px;">ğŸ¯ ë©˜í†  ì •ë³´ ì„¤ì •</h2>
                            <p style="color: #666;">ë¶„ê³¼ë³„ í˜„í™© ê´€ë¦¬ë¥¼ ìœ„í•œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
                        </div>

                        <div style="background: #e3f2fd; border: 1px solid #1976d2; border-radius: 8px; padding: 12px; margin-bottom: 20px;">
                            <div style="font-weight: 600; color: #1976d2; margin-bottom: 4px;">ğŸ’¡ ì„¤ì • ì•ˆë‚´</div>
                            <div style="color: #1565c0; font-size: 14px; line-height: 1.4;">
                                ì´ ì •ë³´ëŠ” ì¶œì„ì²´í¬ì™€ ë©´ë‹´ í˜„í™©ì„ ë¶„ê³¼ë³„ë¡œ êµ¬ë¶„í•˜ì—¬ ë³´ì—¬ì£¼ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.
                            </div>
                        </div>

                        <form id="mentorSetupForm">
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; font-weight: 600; margin-bottom: 6px;">ë©˜í†  ì´ë¦„ <span style="color: red;">*</span></label>
                                <input type="text" id="mentorNameInput" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;" placeholder="í™ê¸¸ë™" required>
                            </div>

                            <div style="margin-bottom: 16px;">
                                <label style="display: block; font-weight: 600; margin-bottom: 6px;">ì—°ìˆ˜ì›</label>
                                <select id="trainingCenterInput" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                                    <option value="icheon">ì´ì²œ SKTì¸ì¬ê°œë°œì›</option>
                                    <option value="yongin">ìš©ì¸ SKì•„ì¹´ë°ë¯¸</option>
                                    <option value="incheon">ì¸ì²œ SKë¬´ì˜ì—°ìˆ˜ì›</option>
                                </select>
                            </div>

                            <div style="margin-bottom: 16px;">
                                <label style="display: block; font-weight: 600; margin-bottom: 6px;">ë¶„ê³¼ ë²ˆí˜¸ <span style="color: red;">*</span></label>
                                <select id="teamNumberInput" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;" required>
                                    <option value="">ë¶„ê³¼ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                                    <option value="1">1ë¶„ê³¼</option>
                                    <option value="2">2ë¶„ê³¼</option>
                                    <option value="3">3ë¶„ê³¼</option>
                                    <option value="4">4ë¶„ê³¼</option>
                                    <option value="5">5ë¶„ê³¼</option>
                                    <option value="6">6ë¶„ê³¼</option>
                                    <option value="7">7ë¶„ê³¼</option>
                                    <option value="8">8ë¶„ê³¼</option>
                                    <option value="9">9ë¶„ê³¼</option>
                                    <option value="10">10ë¶„ê³¼</option>
                                    <option value="11">11ë¶„ê³¼</option>
                                    <option value="12">12ë¶„ê³¼</option>
                                    <option value="13">13ë¶„ê³¼</option>
                                    <option value="14">14ë¶„ê³¼</option>
                                    <option value="15">15ë¶„ê³¼</option>
                                </select>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <label style="display: block; font-weight: 600; margin-bottom: 6px;">ë‹´ë‹¹ ë©˜í‹° ëª©ë¡</label>
                                <div id="menteeListContainer" style="background: #f8f9fa; border: 2px dashed #ddd; border-radius: 8px; padding: 12px; min-height: 100px;">
                                    <!-- ë©˜í‹° ëª©ë¡ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                                </div>
                                <button type="button" onclick="mentorTeamManager.addMenteeInput()" style="width: 100%; background: #4caf50; color: white; border: none; padding: 10px; border-radius: 6px; margin-top: 8px; cursor: pointer;">+ ë©˜í‹° ì¶”ê°€</button>
                                <small style="color: #666; font-size: 12px; margin-top: 4px; display: block;">
                                    * ë©˜í‹° ì´ë¦„ì„ ì…ë ¥í•˜ë©´ ë©´ë‹´ í˜„í™©ì—ì„œ ì§„í–‰ë¥ ì„ ì •í™•íˆ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
                                </small>
                            </div>

                            <div style="display: flex; gap: 8px;">
                                <button type="submit" style="flex: 1; background: #1976d2; color: white; border: none; padding: 14px; border-radius: 8px; font-weight: 600; cursor: pointer;">
                                    âœ… ì„¤ì • ì™„ë£Œ
                                </button>
                                <button type="button" onclick="closeMentorSetupModal()" style="background: #f5f5f5; color: #666; border: none; padding: 14px 20px; border-radius: 8px; cursor: pointer;">
                                    ì·¨ì†Œ
                                </button>
                            </div>
                        </form>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                // ê¸°ì¡´ ì •ë³´ ë³µì›
                this.loadExistingInfo();
                
                // ê¸°ë³¸ ë©˜í‹° í•˜ë‚˜ ì¶”ê°€
                this.addMenteeInput();
                
                // í¼ ì œì¶œ ì´ë²¤íŠ¸
                document.getElementById('mentorSetupForm').addEventListener('submit', (e) => {
                    this.handleMentorSetup(e);
                });
            }

            // ê¸°ì¡´ ì •ë³´ ë³µì›
            loadExistingInfo() {
                if (this.mentorInfo) {
                    document.getElementById('mentorNameInput').value = this.mentorInfo.name || '';
                    document.getElementById('trainingCenterInput').value = this.mentorInfo.trainingCenter || 'icheon';
                    document.getElementById('teamNumberInput').value = this.mentorInfo.teamNumber || '';
                    
                    if (this.mentorInfo.mentees && this.mentorInfo.mentees.length > 0) {
                        this.mentorInfo.mentees.forEach(menteeName => {
                            this.addMenteeInput(menteeName);
                        });
                    }
                }
            }

            // ë©˜í‹° ì…ë ¥ í•„ë“œ ì¶”ê°€
            addMenteeInput(name = '') {
                const container = document.getElementById('menteeListContainer');
                const menteeCount = container.children.length + 1;
                
                const menteeItem = document.createElement('div');
                menteeItem.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    margin-bottom: 6px;
                    padding: 8px;
                    background: white;
                    border-radius: 6px;
                    border-left: 3px solid #1976d2;
                `;
                
                menteeItem.innerHTML = `
                    <div style="background: #1976d2; color: white; width: 20px; height: 20px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 600;">${menteeCount}</div>
                    <input type="text" placeholder="ë©˜í‹° ì´ë¦„ ì…ë ¥" value="${name}" style="flex: 1; border: none; padding: 4px; font-size: 14px; background: transparent;">
                    <button type="button" onclick="this.parentElement.remove(); mentorTeamManager.updateMenteeNumbers()" style="background: #f44336; color: white; border: none; width: 20px; height: 20px; border-radius: 50%; cursor: pointer; font-size: 12px;">Ã—</button>
                `;
                
                container.appendChild(menteeItem);
            }

            // ë©˜í‹° ë²ˆí˜¸ ì—…ë°ì´íŠ¸
            updateMenteeNumbers() {
                const container = document.getElementById('menteeListContainer');
                const menteeItems = container.children;
                
                Array.from(menteeItems).forEach((item, index) => {
                    const numberDiv = item.querySelector('div');
                    if (numberDiv) {
                        numberDiv.textContent = index + 1;
                    }
                });
            }

            // ë©˜í†  ì„¤ì • ì²˜ë¦¬
            handleMentorSetup(e) {
                e.preventDefault();
                
                const mentorName = document.getElementById('mentorNameInput').value.trim();
                const trainingCenter = document.getElementById('trainingCenterInput').value;
                const teamNumber = document.getElementById('teamNumberInput').value;
                
                // í•„ìˆ˜ í•„ë“œ ê²€ì¦
                if (!mentorName || !teamNumber) {
                    alert('ë©˜í†  ì´ë¦„ê³¼ ë¶„ê³¼ ë²ˆí˜¸ëŠ” í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.');
                    return;
                }
                
                // ë©˜í‹° ëª©ë¡ ìˆ˜ì§‘
                const menteeInputs = document.querySelectorAll('#menteeListContainer input');
                const mentees = Array.from(menteeInputs)
                    .map(input => input.value.trim())
                    .filter(name => name.length > 0);
                
                // ë©˜í†  ì •ë³´ ì €ì¥
                const mentorInfo = {
                    name: mentorName,
                    trainingCenter: trainingCenter,
                    teamNumber: teamNumber,
                    mentees: mentees,
                    setupDate: new Date().toISOString(),
                    id: `${trainingCenter}_${teamNumber}_${mentorName}`
                };
                
                localStorage.setItem('sk-mentor-info', JSON.stringify(mentorInfo));
                localStorage.setItem('sk-mentor-name', mentorName); // ê¸°ì¡´ í˜¸í™˜ì„±
                
                this.mentorInfo = mentorInfo;
                
                // ëª¨ë‹¬ ë‹«ê¸°
                const modal = document.querySelector('div[style*="position: fixed"]');
                if (modal) {
                    modal.remove();
                }
                
                // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
                this.updateDashboard();
                
                // ì„±ê³µ ë©”ì‹œì§€
                this.showToast(`âœ… ë©˜í†  ì •ë³´ê°€ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!\në©˜í† : ${mentorName} | ë¶„ê³¼: ${teamNumber}ë¶„ê³¼ | ë©˜í‹°: ${mentees.length}ëª…`, 'success');
            }

            // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸ (ë¶„ê³¼ë³„ í˜„í™©)
            updateDashboard() {
                if (!this.mentorInfo) return;

                // í—¤ë” ì—…ë°ì´íŠ¸
                this.updateHeader();
                
                // ë©´ë‹´ í˜„í™© ì—…ë°ì´íŠ¸
                this.updateInterviewStatus();
                
                // ì¶œì„ì²´í¬ í˜„í™© ì—…ë°ì´íŠ¸
                this.updateAttendanceStatus();
                
                // í€µ ì•¡ì…˜ ì—…ë°ì´íŠ¸
                this.updateQuickActions();
            }

            // í—¤ë” ì—…ë°ì´íŠ¸
            updateHeader() {
                const subtitle = document.getElementById('headerSubtitle');
                if (subtitle && this.mentorInfo) {
                    // localStorageì—ì„œ ì‹¤ì œ ì„ íƒëœ ì—°ìˆ˜ì› ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                    const selectedCenter = localStorage.getItem('selectedCenter');
                    
                    // ì‹¤ì œ ì„ íƒëœ ì—°ìˆ˜ì›ì— ë”°ë¥¸ ì´ë¦„ ë§¤í•‘
                    const centerMap = {
                        'icheon': 'ì´ì²œ SKTì¸ì¬ê°œë°œì›',  // FMI â†’ SKTë¡œ ë³€ê²½
                        'yongin': 'ìš©ì¸ SKì•„ì¹´ë°ë¯¸',
                        'incheon': 'ì¸ì²œ SKë¬´ì˜ì—°ìˆ˜ì›',
                        'sunning': 'ì¨ë‹ ë¦¬ë”ì‹­ì„¼í„°',
                        'sbti' : 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ì—°ìˆ˜ì›'
                    };
                    
                    // ì‹¤ì œ ì„ íƒëœ ì—°ìˆ˜ì›ì˜ ì´ë¦„ ì‚¬ìš©
                    const centerName = selectedCenter ? centerMap[selectedCenter] : 'ì—°ìˆ˜ì› ë¯¸ì„¤ì •';
                    
                    subtitle.textContent = `2025ë…„ 7ì›” SKê·¸ë£¹ ì‹ ì…êµ¬ì„±ì›ê³¼ì • - ${centerName} ${this.mentorInfo.teamNumber}ë¶„ê³¼`;
                }
            }

            // ì—°ìˆ˜ì› ì´ë¦„ ë³€í™˜
            getCenterName(centerId) {
                const centers = {
                    'icheon': 'ì´ì²œ SKTì¸ì¬ê°œë°œì›',
                    'yongin': 'ìš©ì¸ SKì•„ì¹´ë°ë¯¸',
                    'incheon': 'ì¸ì²œ SKë¬´ì˜ì—°ìˆ˜ì›',
                    'sunning': 'ì¨ë‹ ë¦¬ë”ì‹­ì„¼í„°',
                    'sbti' : 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ì—°ìˆ˜ì›'
                };
                return centers[centerId] || centerId;
            }

            // ë©´ë‹´ í˜„í™© ì—…ë°ì´íŠ¸ (ë¶„ê³¼ë³„)
            updateInterviewStatus() {
                if (!this.mentorInfo) return;

                const submissions = JSON.parse(localStorage.getItem('sk-mentor-submissions') || '[]');
                
                // ìš°ë¦¬ ë¶„ê³¼ì˜ ë©´ë‹´ ì œì¶œ í˜„í™©ë§Œ í•„í„°ë§
                const myInterviewSubmissions = submissions.filter(s => 
                    s.type === 'interview' && 
                    s.mentorName === this.mentorInfo.name
                );
                
                const totalMentees = this.mentorInfo.mentees.length;
                const completed = myInterviewSubmissions.length;
                const pending = totalMentees - completed;
                const progress = totalMentees > 0 ? Math.round((completed / totalMentees) * 100) : 0;
                
                // UI ì—…ë°ì´íŠ¸
                this.updateElement('totalMentees', totalMentees);
                this.updateElement('completedInterviews', completed);
                this.updateElement('pendingInterviews', pending);
                this.updateElement('interviewProgress', progress + '%');
                
                const progressBar = document.getElementById('totalInterviewProgress');
                if (progressBar) {
                    progressBar.style.width = progress + '%';
                }
                
                // ìƒíƒœ ì—…ë°ì´íŠ¸
                const statusElement = document.getElementById('interviewStatus');
                if (statusElement) {
                    if (progress === 100) {
                        statusElement.textContent = 'ì™„ë£Œ';
                        statusElement.className = 'task-status status-complete';
                    } else if (progress > 0) {
                        statusElement.textContent = 'ì§„í–‰ì¤‘';
                        statusElement.className = 'task-status status-partial';
                    } else {
                        statusElement.textContent = 'ëŒ€ê¸°ì¤‘';
                        statusElement.className = 'task-status status-pending';
                    }
                }

                // ë©´ë‹´ ìš”ì•½ ì—…ë°ì´íŠ¸
                this.updateElement('interviewSummary', `${completed}/${totalMentees}ëª… ì™„ë£Œ (${progress}%)`);
                
                // ë©´ë‹´ ëŒ€ìƒì ëª©ë¡ í‘œì‹œ
                this.updateInterviewDetails(myInterviewSubmissions);
            }

            // ë©´ë‹´ ìƒì„¸ ì •ë³´ ì—…ë°ì´íŠ¸
            updateInterviewDetails(completedInterviews) {
                const detailsContainer = document.getElementById('interviewDetails');
                if (!detailsContainer) return;

                // ë©´ë‹´ ì™„ë£Œëœ ë©˜í‹° ì´ë¦„ë“¤
                const completedMentees = completedInterviews.map(interview => interview.studentName);
                
                // ë©´ë‹´ ëŒ€ê¸° ì¤‘ì¸ ë©˜í‹°ë“¤
                const pendingMentees = this.mentorInfo.mentees.filter(mentee => 
                    !completedMentees.includes(mentee)
                );
                
                let detailsHtml = '<div style="margin-top: 12px; font-size: 13px;">';
                
                if (completedMentees.length > 0) {
                    detailsHtml += `<div style="color: #4caf50; margin-bottom: 4px;">âœ… ì™„ë£Œ: ${completedMentees.join(', ')}</div>`;
                }
                
                if (pendingMentees.length > 0) {
                    detailsHtml += `<div style="color: #ff9800;">â³ ëŒ€ê¸°: ${pendingMentees.join(', ')}</div>`;
                }
                
                detailsHtml += '</div>';
                detailsContainer.innerHTML = detailsHtml;
            }

            // ì¶œì„ì²´í¬ í˜„í™© ì—…ë°ì´íŠ¸ (ë¶„ê³¼ë³„)
            updateAttendanceStatus() {
                if (!this.mentorInfo) return;

                const submissions = JSON.parse(localStorage.getItem('sk-mentor-submissions') || '[]');
                const today = new Date().toLocaleDateString('ko-KR');
                
                // ìš°ë¦¬ ë¶„ê³¼ì˜ ì¶œì„ì²´í¬ë§Œ í•„í„°ë§
                const myAttendanceSubmissions = submissions.filter(s => 
                    s.type === 'attendance' && 
                    s.mentorName === this.mentorInfo.name &&
                    s.attendance.date === today
                );
                
                const morningDone = myAttendanceSubmissions.some(s => 
                    s.attendance.timeSlot === 'morning'
                );
                
                const afternoonDone = myAttendanceSubmissions.some(s => 
                    s.attendance.timeSlot === 'afternoon'
                );

                let summaryText = '';
                if (morningDone && afternoonDone) {
                    summaryText = 'ì˜¤ì „Â·ì˜¤í›„ ì™„ë£Œ';
                } else if (morningDone) {
                    summaryText = 'ì˜¤ì „ ì™„ë£Œ, ì˜¤í›„ ëŒ€ê¸°ì¤‘';
                } else if (afternoonDone) {
                    summaryText = 'ì˜¤ì „ ë¯¸ì™„ë£Œ, ì˜¤í›„ ì™„ë£Œ';
                } else {
                    summaryText = 'ì˜¤ì „Â·ì˜¤í›„ ëŒ€ê¸°ì¤‘';
                }

                this.updateElement('attendanceSummary', summaryText);
            }

            // í€µ ì•¡ì…˜ ì—…ë°ì´íŠ¸
            updateQuickActions() {
                const mentorInfoDesc = document.getElementById('mentorInfoDesc');
                if (mentorInfoDesc && this.mentorInfo) {
                    mentorInfoDesc.textContent = `${this.mentorInfo.teamNumber}ë¶„ê³¼ (${this.mentorInfo.mentees.length}ëª…)`;
                }
            }

            // ìš”ì†Œ ì—…ë°ì´íŠ¸ í—¬í¼
            updateElement(id, value) {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = value;
                }
            }

            // ë©˜í†  ì •ë³´ ë³´ê¸°/ìˆ˜ì •
            showMentorInfo() {
                if (!this.mentorInfo) {
                    this.showMentorSetupForm();
                    return;
                }

                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.7);
                    z-index: 10000;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    padding: 20px;
                `;
                
                const centerName = this.getCenterName(this.mentorInfo.trainingCenter);
                const menteeList = this.mentorInfo.mentees.length > 0 
                    ? this.mentorInfo.mentees.join(', ') 
                    : 'ë“±ë¡ëœ ë©˜í‹°ê°€ ì—†ìŠµë‹ˆë‹¤';
                
                modal.innerHTML = `
                    <div style="
                        background: white;
                        border-radius: 16px;
                        padding: 24px;
                        max-width: 500px;
                        width: 100%;
                        max-height: 80vh;
                        overflow-y: auto;
                        box-shadow: 0 20px 40px rgba(0,0,0,0.3);
                    ">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <h2 style="color: #1976d2;">ğŸ‘¤ ë©˜í†  ì •ë³´</h2>
                            <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="
                                background: none;
                                border: none;
                                font-size: 24px;
                                cursor: pointer;
                                color: #666;
                            ">Ã—</button>
                        </div>
                        
                        <div style="margin-bottom: 16px;">
                            <strong>ë©˜í† :</strong> ${this.mentorInfo.name}
                        </div>
                        <div style="margin-bottom: 16px;">
                            <strong>ì—°ìˆ˜ì›:</strong> ${centerName}
                        </div>
                        <div style="margin-bottom: 16px;">
                            <strong>ë¶„ê³¼:</strong> ${this.mentorInfo.teamNumber}ë¶„ê³¼
                        </div>
                        <div style="margin-bottom: 24px;">
                            <strong>ë‹´ë‹¹ ë©˜í‹° (${this.mentorInfo.mentees.length}ëª…):</strong><br>
                            <div style="background: #f8f9fa; padding: 12px; border-radius: 8px; margin-top: 8px; font-size: 14px; line-height: 1.5;">
                                ${menteeList}
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 12px;">
                            <button onclick="mentorTeamManager.showMentorSetupForm()" style="
                                flex: 1;
                                background: #1976d2;
                                color: white;
                                border: none;
                                padding: 12px;
                                border-radius: 8px;
                                font-weight: 600;
                                cursor: pointer;
                            ">
                                ì •ë³´ ìˆ˜ì •
                            </button>
                            <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="
                                background: #f5f5f5;
                                color: #666;
                                border: none;
                                padding: 12px 24px;
                                border-radius: 8px;
                                cursor: pointer;
                            ">
                                ë‹«ê¸°
                            </button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
            }

            // ë©´ë‹´ ê¸°ë¡ ë³´ê¸° (ë¶„ê³¼ë³„)
            viewMyInterviewHistory() {
                if (!this.mentorInfo) {
                    alert('ë©˜í†  ì •ë³´ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                    return;
                }

                const submissions = JSON.parse(localStorage.getItem('sk-mentor-submissions') || '[]');
                const myInterviewSubmissions = submissions.filter(s => 
                    s.type === 'interview' && 
                    s.mentorName === this.mentorInfo.name
                );
                
                if (myInterviewSubmissions.length === 0) {
                    alert('ì•„ì§ ì œì¶œëœ ë©´ë‹´ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                let historyText = `ğŸ“Š ${this.mentorInfo.teamNumber}ë¶„ê³¼ 1:1 ë©´ë‹´ ê¸°ë¡\n\n`;
                myInterviewSubmissions.forEach((submission, index) => {
                    historyText += `${index + 1}. ${submission.studentName}\n`;
                    historyText += `   ë©´ë‹´ì¼ì‹œ: ${submission.interviewDate}\n`;
                    historyText += `   ì œì¶œì‹œê°„: ${submission.submittedAt}\n\n`;
                });
                
                alert(historyText);
            }

            // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
            showToast(message, type = 'info') {
                const toast = document.createElement('div');
                toast.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${type === 'success' ? '#4caf50' : '#2196f3'};
                    color: white;
                    padding: 12px 16px;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                    z-index: 10001;
                    max-width: 300px;
                    word-wrap: break-word;
                `;
                
                toast.textContent = message;
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 3000);
            }
        }

    // =================================================================
    // ëª¨ë°”ì¼ PWA í‘¸ì‹œ ì•Œë¦¼ ì‹œìŠ¤í…œ
    // =================================================================
    class MobilePushNotificationManager {
    constructor() {
        this.isSupported = 'Notification' in window && 'serviceWorker' in navigator && 'PushManager' in window;
        this.permission = Notification.permission;
        this.serviceWorkerRegistration = null;
        this.pushSubscription = null;
        this.messaging = null;
        this.app = null;
        this.init();
    }

    async init() {
        console.log('ğŸ”” Firebase ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì¤‘...');
        
        if (!this.isSupported) {
            console.warn('âŒ ì´ ë¸Œë¼ìš°ì €ëŠ” ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            this.updateNotificationStatus('ì§€ì›ë˜ì§€ ì•ŠìŒ');
            this.hideNotificationBanner();
            return;
        }

        try {
            // Firebase ì´ˆê¸°í™”
            await this.initializeFirebase();
            
            // ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡
            await this.registerServiceWorker();
            
            // ê¸°ì¡´ êµ¬ë… í™•ì¸
            await this.checkExistingSubscription();
            
            // UI ì—…ë°ì´íŠ¸
            this.updateNotificationStatus();
            this.checkNotificationBanner();
            
            // ìë™ ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§
            this.scheduleAutomaticNotifications();
            
            console.log('âœ… Firebase ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ');
        } catch (error) {
            console.error('âŒ Firebase ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
            this.updateNotificationStatus('ì´ˆê¸°í™” ì‹¤íŒ¨');
        }
    }

    async initializeFirebase() {
        try {
            // Firebase SDK ë™ì  ë¡œë“œ
            const { initializeApp } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js');
            const { getMessaging, getToken, onMessage } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-messaging.js');
            
            // Firebase ì„¤ì •
            const firebaseConfig = {
                apiKey: "AIzaSyDubt0Ool50-nQGYOCk1nNm8Xu4mDij3PY",
                authDomain: "sk-mentor-guide.firebaseapp.com",
                projectId: "sk-mentor-guide",
                storageBucket: "sk-mentor-guide.firebasestorage.app",
                messagingSenderId: "474747639627",
                appId: "1:474747639627:web:9d7e6f4f7a37395a39bace",
                measurementId: "G-0CSMF3K8BK"
            };

            // Firebase ì•± ì´ˆê¸°í™”
            this.app = initializeApp(firebaseConfig);
            this.messaging = getMessaging(this.app);
            
            console.log('âœ… Firebase ì•± ì´ˆê¸°í™” ì„±ê³µ');

            // í¬ê·¸ë¼ìš´ë“œ ë©”ì‹œì§€ ì²˜ë¦¬
            onMessage(this.messaging, (payload) => {
                console.log('ğŸ“± í¬ê·¸ë¼ìš´ë“œ ë©”ì‹œì§€ ìˆ˜ì‹ :', payload);
                this.showForegroundNotification(payload);
            });

        } catch (error) {
            console.error('âŒ Firebase ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
            throw error;
        }
    }

    async registerServiceWorker() {
        try {
            this.serviceWorkerRegistration = await navigator.serviceWorker.register('/firebase-messaging-sw.js');
            console.log('âœ… Firebase ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡ ì„±ê³µ');
            
            // ì„œë¹„ìŠ¤ ì›Œì»¤ ì—…ë°ì´íŠ¸ ëŒ€ê¸°
            await navigator.serviceWorker.ready;
            
            return this.serviceWorkerRegistration;
        } catch (error) {
            console.error('âŒ Firebase ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡ ì‹¤íŒ¨:', error);
            
            // ëŒ€ì•ˆ: ê¸°ë³¸ ì„œë¹„ìŠ¤ ì›Œì»¤ ì‚¬ìš©
            try {
                this.serviceWorkerRegistration = await navigator.serviceWorker.register('/sw.js');
                console.log('âœ… ê¸°ë³¸ ì„œë¹„ìŠ¤ ì›Œì»¤ë¡œ ëŒ€ì²´ ë“±ë¡ ì„±ê³µ');
            } catch (fallbackError) {
                console.error('âŒ ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡ ì™„ì „ ì‹¤íŒ¨:', fallbackError);
                throw fallbackError;
            }
        }
    }

    async checkExistingSubscription() {
        if (!this.serviceWorkerRegistration) return;

        try {
            this.pushSubscription = await this.serviceWorkerRegistration.pushManager.getSubscription();
            if (this.pushSubscription) {
                console.log('ğŸ“± ê¸°ì¡´ í‘¸ì‹œ êµ¬ë… ë°œê²¬');
                localStorage.setItem('push-subscription', JSON.stringify(this.pushSubscription.toJSON()));
                
                // FCM í† í°ë„ í™•ì¸
                const savedToken = localStorage.getItem('fcm-token');
                if (savedToken) {
                    console.log('ğŸ’¾ ì €ì¥ëœ FCM í† í° ë°œê²¬');
                }
            }
        } catch (error) {
            console.error('âŒ ê¸°ì¡´ êµ¬ë… í™•ì¸ ì‹¤íŒ¨:', error);
        }
    }

    async requestPermission() {
        if (!this.isSupported) {
            this.showToast('âŒ ì´ ë¸Œë¼ìš°ì €ëŠ” ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
            return false;
        }

        if (!this.messaging) {
            this.showToast('âŒ Firebaseê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.', 'error');
            return false;
        }

        try {
            // 1. ì•Œë¦¼ ê¶Œí•œ ìš”ì²­
            console.log('ğŸ”” ì•Œë¦¼ ê¶Œí•œ ìš”ì²­ ì¤‘...');
            const permission = await Notification.requestPermission();
            this.permission = permission;
            
            if (permission !== 'granted') {
                this.showToast('âŒ ì•Œë¦¼ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'error');
                this.updateNotificationStatus('ê¶Œí•œ ê±°ë¶€ë¨');
                return false;
            }

            console.log('âœ… ì•Œë¦¼ ê¶Œí•œ íšë“ ì„±ê³µ');

            // 2. FCM í† í° íšë“
            console.log('ğŸ”‘ FCM í† í° íšë“ ì¤‘...');
            const { getToken } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-messaging.js');
            
            const token = await getToken(this.messaging, {
                vapidKey: 'BApyOxrl4CLNL2LwaGBE9oIddaWP1s70TzOCpadIDt9FN3mWa4ZxYzlMy8U5RCITCV34DKafqNd2SpDRmo-TNnI'
            });

            if (!token) {
                throw new Error('FCM í† í°ì„ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }

            console.log('âœ… FCM í† í° íšë“ ì„±ê³µ:', token);
            localStorage.setItem('fcm-token', token);

            // 3. í‘¸ì‹œ êµ¬ë… ìƒì„±
            await this.subscribeToPush();

            // 4. UI ì—…ë°ì´íŠ¸
            this.updateNotificationStatus();
            this.hideNotificationBanner();
            
            // 5. í™˜ì˜ ì•Œë¦¼
            setTimeout(() => {
                this.sendWelcomeNotification();
            }, 1000);
            
            this.showToast('âœ… ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            
            // 6. ì„œë²„ì— í† í° ì „ì†¡ (ì„ íƒì )
            await this.sendTokenToServer(token);
            
            return true;
            
        } catch (error) {
            console.error('âŒ í‘¸ì‹œ ì•Œë¦¼ ì„¤ì • ì‹¤íŒ¨:', error);
            this.showToast(`í‘¸ì‹œ ì•Œë¦¼ ì„¤ì • ì‹¤íŒ¨: ${error.message}`, 'error');
            this.updateNotificationStatus('ì„¤ì • ì‹¤íŒ¨');
            return false;
        }
    }

    async subscribeToPush() {
        if (!this.serviceWorkerRegistration) {
            throw new Error('ì„œë¹„ìŠ¤ ì›Œì»¤ê°€ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
        }

        try {
            // VAPID í‚¤ë¥¼ Uint8Arrayë¡œ ë³€í™˜
            const vapidKey = 'BApyOxrl4CLNL2LwaGBE9oIddaWP1s70TzOCpadIDt9FN3mWa4ZxYzlMy8U5RCITCV34DKafqNd2SpDRmo-TNnI';
            const applicationServerKey = this.urlBase64ToUint8Array(vapidKey);
            
            const subscriptionOptions = {
                userVisibleOnly: true,
                applicationServerKey: applicationServerKey
            };

            this.pushSubscription = await this.serviceWorkerRegistration.pushManager.subscribe(subscriptionOptions);
            
            console.log('âœ… í‘¸ì‹œ êµ¬ë… ìƒì„± ì„±ê³µ');
            localStorage.setItem('push-subscription', JSON.stringify(this.pushSubscription.toJSON()));
            
            return this.pushSubscription;
        } catch (error) {
            console.error('âŒ í‘¸ì‹œ êµ¬ë… ìƒì„± ì‹¤íŒ¨:', error);
            throw error;
        }
    }

    urlBase64ToUint8Array(base64String) {
        const padding = '='.repeat((4 - base64String.length % 4) % 4);
        const base64 = (base64String + padding)
            .replace(/\-/g, '+')
            .replace(/_/g, '/');

        const rawData = window.atob(base64);
        const outputArray = new Uint8Array(rawData.length);

        for (let i = 0; i < rawData.length; ++i) {
            outputArray[i] = rawData.charCodeAt(i);
        }
        return outputArray;
    }

    async sendTokenToServer(token) {
        try {
            // ì—¬ê¸°ì„œ ì‹¤ì œ ì„œë²„ë¡œ í† í° ì „ì†¡
            console.log('ğŸ“¤ ì„œë²„ì— FCM í† í° ì „ì†¡:', token);
            
            // ì‹¤ì œ êµ¬í˜„ ì‹œ ì„œë²„ API í˜¸ì¶œ
            // const response = await fetch('/api/register-fcm-token', {
            //     method: 'POST',
            //     headers: {
            //         'Content-Type': 'application/json',
            //     },
            //     body: JSON.stringify({
            //         token: token,
            //         userId: this.getCurrentUserId(),
            //         deviceInfo: this.getDeviceInfo(),
            //         timestamp: new Date().toISOString()
            //     })
            // });
            
            // if (!response.ok) {
            //     throw new Error('ì„œë²„ í† í° ë“±ë¡ ì‹¤íŒ¨');
            // }
            
            console.log('âœ… ì„œë²„ í† í° ë“±ë¡ ì„±ê³µ (ëª¨ì˜)');
            
        } catch (error) {
            console.error('âŒ ì„œë²„ í† í° ì „ì†¡ ì‹¤íŒ¨:', error);
            // ì—ëŸ¬ê°€ ë°œìƒí•´ë„ í´ë¼ì´ì–¸íŠ¸ ê¸°ëŠ¥ì€ ìœ ì§€
        }
    }

    showForegroundNotification(payload) {
        const { notification, data } = payload;
        
        console.log('ğŸ“± í¬ê·¸ë¼ìš´ë“œ ì•Œë¦¼ í‘œì‹œ:', notification);
        
        // ì»¤ìŠ¤í…€ ì•Œë¦¼ UI í‘œì‹œ
        this.showCustomNotification({
            title: notification?.title || 'SK ë©˜í†  ê°€ì´ë“œ',
            body: notification?.body || 'ìƒˆë¡œìš´ ì•Œë¦¼ì´ ìˆìŠµë‹ˆë‹¤.',
            icon: notification?.icon || '/assets/images/icon-192.png',
            data: data || {}
        });
    }

    showCustomNotification({ title, body, icon, data }) {
        // ê¸°ì¡´ ì•Œë¦¼ ì œê±°
        const existingNotification = document.getElementById('custom-notification');
        if (existingNotification) {
            existingNotification.remove();
        }

        // ì•Œë¦¼ ì»¨í…Œì´ë„ˆ ìƒì„±
        const notification = document.createElement('div');
        notification.id = 'custom-notification';
        notification.className = 'custom-notification show';
        notification.innerHTML = `
            <div class="notification-content">
                <div class="notification-icon">
                    <img src="${icon}" alt="ì•Œë¦¼" onerror="this.src='/assets/images/icon-192.png'">
                </div>
                <div class="notification-text">
                    <div class="notification-title">${title}</div>
                    <div class="notification-body">${body}</div>
                </div>
                <button class="notification-close" onclick="this.parentElement.parentElement.remove()">
                    Ã—
                </button>
            </div>
        `;

        // í´ë¦­ ì´ë²¤íŠ¸
        notification.addEventListener('click', (e) => {
            if (!e.target.closest('.notification-close')) {
                if (data && data.url) {
                    window.location.href = data.url;
                }
                notification.remove();
            }
        });

        // í˜ì´ì§€ì— ì¶”ê°€
        document.body.appendChild(notification);

        // 5ì´ˆ í›„ ìë™ ì œê±°
        setTimeout(() => {
            if (notification.parentElement) {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }
        }, 5000);
        
        // ìŠ¤íƒ€ì¼ì´ ì—†ë‹¤ë©´ ì¶”ê°€
        this.ensureNotificationStyles();
    }

    ensureNotificationStyles() {
        if (document.getElementById('custom-notification-styles')) return;
        
        const style = document.createElement('style');
        style.id = 'custom-notification-styles';
        style.textContent = `
            .custom-notification {
                position: fixed;
                top: 20px;
                right: 20px;
                background: white;
                border-radius: 12px;
                box-shadow: 0 8px 32px rgba(0,0,0,0.12);
                border: 1px solid rgba(0,0,0,0.08);
                max-width: 400px;
                z-index: 10000;
                transform: translateX(100%);
                transition: transform 0.3s ease;
                cursor: pointer;
            }

            .custom-notification.show {
                transform: translateX(0);
            }

            .notification-content {
                display: flex;
                align-items: flex-start;
                padding: 16px;
                gap: 12px;
            }

            .notification-icon img {
                width: 40px;
                height: 40px;
                border-radius: 8px;
            }

            .notification-text {
                flex: 1;
                min-width: 0;
            }

            .notification-title {
                font-weight: 600;
                font-size: 14px;
                color: #1a1a1a;
                margin-bottom: 4px;
                line-height: 1.3;
            }

            .notification-body {
                font-size: 13px;
                color: #666;
                line-height: 1.4;
                word-break: break-word;
            }

            .notification-close {
                background: none;
                border: none;
                color: #999;
                cursor: pointer;
                padding: 4px;
                border-radius: 4px;
                flex-shrink: 0;
                font-size: 16px;
                width: 24px;
                height: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .notification-close:hover {
                background: #f5f5f5;
                color: #666;
            }

            @media (max-width: 480px) {
                .custom-notification {
                    left: 16px;
                    right: 16px;
                    max-width: none;
                    top: 16px;
                }
            }
        `;
        document.head.appendChild(style);
    }

    checkNotificationBanner() {
        const banner = document.getElementById('notificationBanner');
        const dismissed = localStorage.getItem('notification-banner-dismissed');
        
        if (this.permission === 'granted' || dismissed === 'true' || !this.isSupported) {
            if (banner) {
                banner.classList.add('hidden');
            }
        }
    }

    hideNotificationBanner() {
        const banner = document.getElementById('notificationBanner');
        if (banner) {
            banner.classList.add('hidden');
            localStorage.setItem('notification-banner-dismissed', 'true');
        }
    }

    sendWelcomeNotification() {
        this.sendLocalNotification({
            title: 'ğŸ¯ SK ë©˜í†  ê°€ì´ë“œ ì•Œë¦¼ ì„¤ì • ì™„ë£Œ',
            body: 'ì¤‘ìš”í•œ ì—…ë¬´ ì•Œë¦¼ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°›ì•„ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
            tag: 'welcome'
        });
    }

    sendLocalNotification(options) {
        if (this.permission !== 'granted') {
            console.warn('âŒ ì•Œë¦¼ ê¶Œí•œì´ ì—†ì–´ ì•Œë¦¼ì„ ë³´ë‚¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            return;
        }

        if (this.serviceWorkerRegistration) {
            this.serviceWorkerRegistration.showNotification(options.title, {
                body: options.body,
                icon: '/assets/images/icon-192.png',
                badge: '/assets/images/icon-192.png',
                tag: options.tag || 'sk-mentor-guide',
                requireInteraction: true,
                vibrate: [200, 100, 200],
                data: {
                    url: options.url || '/',
                    timestamp: Date.now()
                }
            });
        }
    }

    scheduleAutomaticNotifications() {
        if (this.permission !== 'granted') return;

        const now = new Date();
        const currentHour = now.getHours();
        const currentMinute = now.getMinutes();

        // ì˜¤ì „ 8:50 ì•Œë¦¼ (ì¶œì„ì²´í¬ 10ë¶„ ì „)
        if (currentHour === 8 && currentMinute === 50) {
            this.sendLocalNotification({
                title: 'ğŸŒ… ì˜¤ì „ ì¶œì„ì²´í¬ ì•Œë¦¼',
                body: '10ë¶„ í›„ ì˜¤ì „ 9ì‹œ ì¶œì„ì²´í¬ê°€ ì‹œì‘ë©ë‹ˆë‹¤. ì¤€ë¹„í•´ì£¼ì„¸ìš”!',
                tag: 'attendance-morning',
                url: '/guides/attendance.html'
            });
        }

        // ì˜¤í›„ 1:50 ì•Œë¦¼ (ì¶œì„ì²´í¬ 10ë¶„ ì „)
        if (currentHour === 13 && currentMinute === 50) {
            this.sendLocalNotification({
                title: 'ğŸŒ ì˜¤í›„ ì¶œì„ì²´í¬ ì•Œë¦¼',
                body: '10ë¶„ í›„ ì˜¤í›„ 2ì‹œ ì¶œì„ì²´í¬ê°€ ì‹œì‘ë©ë‹ˆë‹¤. ì¤€ë¹„í•´ì£¼ì„¸ìš”!',
                tag: 'attendance-afternoon',
                url: '/guides/attendance.html'
            });
        }

        // ì €ë… 6ì‹œ í•˜ë£¨ ë§ˆë¬´ë¦¬ ì•Œë¦¼
        if (currentHour === 18 && currentMinute === 0) {
            this.sendLocalNotification({
                title: 'ğŸŒ† í•˜ë£¨ ë§ˆë¬´ë¦¬',
                body: 'ì˜¤ëŠ˜ í•˜ë£¨ ë©˜í† ë§ ì—…ë¬´ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.',
                tag: 'daily-summary',
                url: '/'
            });
        }
    }

    updateNotificationStatus(customStatus = null) {
        const statusElement = document.getElementById('notificationStatus');
        const toggleDesc = document.getElementById('notificationToggleDesc');
        
        let statusText = '';
        let toggleText = '';
        let bgColor = '';
        
        if (customStatus) {
            statusText = `ì•Œë¦¼ ìƒíƒœ: ${customStatus}`;
            toggleText = customStatus;
            bgColor = 'rgba(156, 39, 176, 0.8)';
        } else if (!this.isSupported) {
            statusText = 'ì•Œë¦¼ ìƒíƒœ: ì§€ì›ë˜ì§€ ì•ŠìŒ';
            toggleText = 'ì§€ì›ë˜ì§€ ì•ŠìŒ';
            bgColor = 'rgba(158, 158, 158, 0.8)';
        } else if (this.permission === 'granted') {
            const hasToken = localStorage.getItem('fcm-token');
            if (hasToken) {
                statusText = 'ì•Œë¦¼ ìƒíƒœ: í™œì„±í™”ë¨';
                toggleText = 'í™œì„±í™”ë¨';
                bgColor = 'rgba(76, 175, 80, 0.8)';
            } else {
                statusText = 'ì•Œë¦¼ ìƒíƒœ: í† í° ëŒ€ê¸°ì¤‘';
                toggleText = 'ì„¤ì • ì¤‘';
                bgColor = 'rgba(255, 152, 0, 0.8)';
            }
        } else if (this.permission === 'denied') {
            statusText = 'ì•Œë¦¼ ìƒíƒœ: ì°¨ë‹¨ë¨';
            toggleText = 'ì°¨ë‹¨ë¨';
            bgColor = 'rgba(244, 67, 54, 0.8)';
        } else {
            statusText = 'ì•Œë¦¼ ìƒíƒœ: ë¹„í™œì„±í™”';
            toggleText = 'ë¹„í™œì„±í™”';
            bgColor = 'rgba(255, 152, 0, 0.8)';
        }
        
        if (statusElement) {
            statusElement.textContent = statusText;
            statusElement.style.background = bgColor;
            statusElement.classList.add('show');
            
            setTimeout(() => {
                statusElement.classList.remove('show');
            }, 3000);
        }
        
        if (toggleDesc) {
            toggleDesc.textContent = toggleText;
        }
    }

    showToast(message, type = 'info') {
        const toast = document.createElement('div');
        toast.style.cssText = `
            position: fixed;
            top: 80px;
            right: 20px;
            background: ${type === 'success' ? '#4caf50' : type === 'error' ? '#f44336' : '#2196f3'};
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 10002;
            max-width: 300px;
            word-wrap: break-word;
            font-weight: 600;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        `;
        
        toast.textContent = message;
        document.body.appendChild(toast);
        
        setTimeout(() => {
            toast.style.transform = 'translateX(0)';
        }, 100);
        
        setTimeout(() => {
            toast.style.transform = 'translateX(100%)';
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            }, 300);
        }, 4000);
    }

    async unsubscribe() {
        try {
            if (this.pushSubscription) {
                await this.pushSubscription.unsubscribe();
                this.pushSubscription = null;
                localStorage.removeItem('push-subscription');
                localStorage.removeItem('fcm-token');
                console.log('âœ… í‘¸ì‹œ êµ¬ë… í•´ì œ ì™„ë£Œ');
                this.updateNotificationStatus('êµ¬ë… í•´ì œë¨');
                this.showToast('ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
                return true;
            }
        } catch (error) {
            console.error('âŒ í‘¸ì‹œ êµ¬ë… í•´ì œ ì‹¤íŒ¨:', error);
            this.showToast('êµ¬ë… í•´ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            return false;
        }
    }

    getCurrentUserId() {
        // ë©˜í†  ì •ë³´ì—ì„œ ê³ ìœ  ID ìƒì„±
        const mentorInfo = JSON.parse(localStorage.getItem('sk-mentor-info') || '{}');
        
        if (mentorInfo.name && mentorInfo.teamNumber) {
            // "ë©˜í† ì´ë¦„_ë¶„ê³¼ë²ˆí˜¸" í˜•íƒœë¡œ ê³ ìœ  ID ìƒì„±
            return `${mentorInfo.name}_${mentorInfo.teamNumber}ë¶„ê³¼`;
        }
        
        // ë©˜í†  ì •ë³´ê°€ ì—†ìœ¼ë©´ ì„ì‹œ ID
        return `anonymous_${Date.now()}`;
    }

    getDeviceInfo() {
        return {
            userAgent: navigator.userAgent,
            platform: navigator.platform,
            language: navigator.language,
            screenResolution: `${screen.width}x${screen.height}`,
            timestamp: new Date().toISOString()
        };
    }
}
    

        // =================================================================
        // ê¸°ì¡´ í•¨ìˆ˜ë“¤ê³¼ í†µí•©
        // =================================================================

        // ì „ì—­ ì¸ìŠ¤í„´ìŠ¤
        let mentorTeamManager;

        let mobilePushManager;

        // ì¶œì„ì²´í¬ ìƒíƒœ í™•ì¸
        function checkAttendanceStatus() {
            const now = new Date();
            const hour = now.getHours();
            const minute = now.getMinutes();
            
            // ì˜¤ì „ ì¶œì„ì²´í¬ (9:00 ~ 9:30)
            const submissions = JSON.parse(localStorage.getItem('sk-mentor-submissions') || '[]');
            const todayMorning = submissions.find(s => 
                s.type === 'attendance' && 
                s.attendance.timeSlot === 'morning' &&
                s.attendance.date === new Date().toLocaleDateString('ko-KR')
            );
            
            if (todayMorning) {
                updateTaskStatus('morning', 'ì™„ë£Œ', 'complete', 100);
            } else if (hour >= 9 && hour < 10) {
                updateTaskStatus('morning', 'ì§„í–‰ í•„ìš”', 'urgent', 0);
                showNotification('ì˜¤ì „ ì¶œì„ì²´í¬', 'ì˜¤ì „ 9ì‹œ ì¶œì„ì²´í¬ë¥¼ ì§„í–‰í•´ì£¼ì„¸ìš”.');
            } else if (hour < 9) {
                updateTaskStatus('morning', 'ì¤€ë¹„ì¤‘', 'pending', 0);
            }
            
            // ì˜¤í›„ ì¶œì„ì²´í¬ (14:00 ~ 14:30)
            const todayAfternoon = submissions.find(s => 
                s.type === 'attendance' && 
                s.attendance.timeSlot === 'afternoon' &&
                s.attendance.date === new Date().toLocaleDateString('ko-KR')
            );
            
            if (todayAfternoon) {
                updateTaskStatus('afternoon', 'ì™„ë£Œ', 'complete', 100);
            } else if (hour >= 14 && hour < 15) {
                updateTaskStatus('afternoon', 'ì§„í–‰ í•„ìš”', 'urgent', 0);
                showNotification('ì˜¤í›„ ì¶œì„ì²´í¬', 'ì˜¤í›„ 2ì‹œ ì¶œì„ì²´í¬ë¥¼ ì§„í–‰í•´ì£¼ì„¸ìš”.');
            } else if (hour < 14) {
                updateTaskStatus('afternoon', 'ëŒ€ê¸°ì¤‘', 'pending', 0);
            }

            // ë©˜í†  íŒ€ ë§¤ë‹ˆì €ê°€ ìˆìœ¼ë©´ ì¶œì„ì²´í¬ í˜„í™© ì—…ë°ì´íŠ¸
            if (mentorTeamManager) {
                mentorTeamManager.updateAttendanceStatus();
            }                        
        }
        
        // íƒœìŠ¤í¬ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateTaskStatus(timeSlot, statusText, statusClass, progress) {
            const statusElement = document.getElementById(`${timeSlot}Status`);
            const progressElement = document.getElementById(`${timeSlot}Progress`);
            
            if (statusElement) {
                statusElement.textContent = statusText;
                statusElement.className = `task-status status-${statusClass}`;
            }
            
            if (progressElement) {
                progressElement.style.width = progress + '%';
            }
        }

        // ë©´ë‹´ í˜„í™© ì—…ë°ì´íŠ¸ (ë©˜í†  íŒ€ ë§¤ë‹ˆì €ë¡œ ìœ„ì„)
        function updateInterviewStatus() {
            if (mentorTeamManager) {
                mentorTeamManager.updateInterviewStatus();
            }
        }

        // ì¶œì„ì²´í¬ ìš”ì•½ ì—…ë°ì´íŠ¸ (ë©˜í†  íŒ€ ë§¤ë‹ˆì €ë¡œ ìœ„ì„)
        function updateAttendanceSummary() {
            if (mentorTeamManager) {
                mentorTeamManager.updateAttendanceStatus();
            }
        }

        // ì•Œë¦¼ í‘œì‹œ
        function showNotification(title, message) {
            const notifications = document.getElementById('notifications');
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `
                <div class="notification-title">${title}</div>
                <div class="notification-text">${message}</div>
            `;
            notifications.appendChild(notification);
            
            // 5ì´ˆ í›„ ìë™ ì œê±°
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // í€µ ì•¡ì…˜ë“¤
        function quickAttendance() {
            window.location.href = 'guides/attendance.html';
        }

        function quickInterview() {
            window.location.href = 'guides/interview.html';
        }

        // ë©´ë‹´ ê¸°ë¡ ë³´ê¸° (ë¶„ê³¼ë³„)
        function viewInterviewHistory() {
            if (mentorTeamManager) {
                mentorTeamManager.viewMyInterviewHistory();
            } else {
                // ê¸°ì¡´ ë¡œì§ (ì „ì²´ ë³´ê¸°)
                const submissions = JSON.parse(localStorage.getItem('sk-mentor-submissions') || '[]');
                const interviewSubmissions = submissions.filter(s => s.type === 'interview');
                
                if (interviewSubmissions.length === 0) {
                    alert('ì•„ì§ ì œì¶œëœ ë©´ë‹´ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                let historyText = 'ğŸ“Š 1:1 ë©´ë‹´ ê¸°ë¡\n\n';
                interviewSubmissions.forEach((submission, index) => {
                    historyText += `${index + 1}. ${submission.studentName} (${submission.mentorName})\n`;
                    historyText += `   ì¼ì‹œ: ${submission.interviewDate}\n`;
                    historyText += `   ì œì¶œ: ${submission.submittedAt}\n\n`;
                });
                
                alert(historyText);
            }
        }

        // ì œì¶œ ë‚´ì—­ ë³´ê¸°
        function viewSubmissions() {
            const submissions = JSON.parse(localStorage.getItem('sk-mentor-submissions') || '[]');
            
            if (submissions.length === 0) {
                alert('ì œì¶œëœ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            let submissionText = 'ğŸ“„ ì œì¶œ ë‚´ì—­\n\n';
            submissions.forEach((submission, index) => {
                if (submission.type === 'attendance') {
                    submissionText += `${index + 1}. ì¶œì„ì²´í¬ (${submission.attendance.timeSlot === 'morning' ? 'ì˜¤ì „' : 'ì˜¤í›„'})\n`;
                    submissionText += `   ì¼ì‹œ: ${submission.attendance.date} ${submission.attendance.submittedAt}\n\n`;
                } else if (submission.type === 'interview') {
                    submissionText += `${index + 1}. 1:1 ë©´ë‹´ - ${submission.studentName}\n`;
                    submissionText += `   ì¼ì‹œ: ${submission.submittedAt}\n\n`;
                }
            });
            
            alert(submissionText);
        }

        // ë©˜í†  ì •ë³´ í‘œì‹œ (í€µ ì•¡ì…˜ì—ì„œ í˜¸ì¶œ)
        function showMentorInfo() {
            if (mentorTeamManager) {
                mentorTeamManager.showMentorInfo();
            }
        }

        // ì²´í¬ë¦¬ìŠ¤íŠ¸ í‘œì‹œ í•¨ìˆ˜
        function showChecklist(programId) {
            const checklists = {
                'vision-building': 'âœ… Vision Building ì¤€ë¹„ì‚¬í•­\n\nâ€¢ ì¥í‘œ ì¤€ë¹„ (+ BGM)\nâ€¢ ì¡°ë³„ ì´ì ¤íŒ¨ë“œ (4ê°œ)\nâ€¢ 12ìƒ‰ ì‚¬ì¸íœ\nâ€¢ í¬ìŠ¤íŠ¸ì‡\nâ€¢ 4X4 ë¹™ê³ íŒ',
                'memorial-tour': 'âœ… ê¸°ë…ê´€ Tour ì¤€ë¹„ì‚¬í•­\n\nâ€¢ ê°œì¸ ë…¸íŠ¸ë¶ ì±™ê¸°ê¸°\nâ€¢ ìŠ¤í† ë¦¬í…”ë§ ìŠ¤í¬ë¦½íŠ¸ ìˆ™ì§€\nâ€¢ ì¸µë³„ ì´ë™ ê²½ë¡œ íŒŒì•…',
                'interview': 'âœ… 1:1 ë©´ë‹´ ì¤€ë¹„ì‚¬í•­\n\nâ€¢ ì¡°ìš©í•œ ë©´ë‹´ ì¥ì†Œ í™•ë³´\nâ€¢ ì¶©ë¶„í•œ ì‹œê°„ í™•ë³´ (15-20ë¶„)\nâ€¢ ì§ˆë¬¸ ì˜ˆì‹œ ìˆ™ì§€\nâ€¢ ê¸°ë¡ì§€ ì¤€ë¹„',
                'daily-opening': 'âœ… Daily Opening ì¤€ë¹„ì‚¬í•­\n\nâ€¢ 8ì‹œ 30ë¶„ ì „ ë¶„ê³¼ì¥ ë„ì°©\nâ€¢ ì˜¤í”„ë‹ ì¥í‘œ ì¤€ë¹„\nâ€¢ BGM ì¤€ë¹„\nâ€¢ ë‹¹ì¼ ì‹œê°„í‘œ í™•ì¸',
                'growth-roadmap': 'âœ… ì„±ì¥ Roadmap ì¤€ë¹„ì‚¬í•­\n\nâ€¢ ì„±ì¥ Roadmap ì¥í‘œ ì¤€ë¹„\nâ€¢ ê°•ì  ì§„ë‹¨ ê²°ê³¼ í™•ì¸\nâ€¢ ê°€ì´ë“œ ì§ˆë¬¸ ìˆ™ì§€',
                'play-skms': 'âœ… Play SKMS ì¤€ë¹„ì‚¬í•­\n\nâ€¢ ì¡°ë³„ ì´ì ¤íŒ¨ë“œ (4ê°œ)\nâ€¢ ì‚¬ì¸íœ, í¬ìŠ¤íŠ¸ì‡\nâ€¢ VWBE ê´€ì°° í¬ì¸íŠ¸ ìˆ™ì§€'
            };
            
            alert(checklists[programId] || 'ì¤€ë¹„ì‚¬í•­ì„ í™•ì¸ ì¤‘ì…ë‹ˆë‹¤.');
        }

        // ğŸ†• ê°€ì´ë“œë¼ì¸ í† ê¸€ í•¨ìˆ˜ ì¶”ê°€
        function toggleGuidelines() {
            const content = document.getElementById('guidelinesContent');
            const icon = document.getElementById('toggleIcon');
            
            if (content && icon) {
                if (content.classList.contains('expanded')) {
                    content.classList.remove('expanded');
                    icon.textContent = 'â–¼';
                    icon.style.transform = 'rotate(0deg)';
                } else {
                    content.classList.add('expanded');
                    icon.textContent = 'â–²';
                    icon.style.transform = 'rotate(180deg)';
                }
            }
        }
        
        // ğŸ†• í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ í•¨ìˆ˜ë“¤ (toggleGuidelines í•¨ìˆ˜ ë‹¤ìŒì— ì¶”ê°€)
        function goToHome() {
            setActiveNav(0);
            // ì´ë¯¸ í™ˆ í˜ì´ì§€ì´ë¯€ë¡œ í˜ì´ì§€ ìƒë‹¨ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function openMyPage() {
            const modal = document.getElementById('myPageModal');
            
            // ë©˜í†  ì •ë³´ ë¡œë“œ ë° í‘œì‹œ
            loadMentorInfoToModal();
            
            // ëª¨ë‹¬ í‘œì‹œ
            modal.classList.add('active');
            
            // body ìŠ¤í¬ë¡¤ ë°©ì§€
            document.body.style.overflow = 'hidden';
        }

        function closeMyPage() {
            const modal = document.getElementById('myPageModal');
            modal.classList.remove('active');
            
            // body ìŠ¤í¬ë¡¤ ë³µì›
            document.body.style.overflow = '';
        }

        function loadMentorInfoToModal() {
            const infoGrid = document.getElementById('myInfoGrid');
            
            // ê¸°ì¡´ ë©˜í†  ì •ë³´ ê°€ì ¸ì˜¤ê¸° (MentorTeamManagerì—ì„œ)
            let mentorInfo = null;
            if (mentorTeamManager && mentorTeamManager.mentorInfo) {
                mentorInfo = mentorTeamManager.mentorInfo;
            }
            
            if (mentorInfo) {
                // ì„¤ì •ëœ ë©˜í†  ì •ë³´ í‘œì‹œ
                const centerName = getCenterDisplayName(mentorInfo.trainingCenter);
                
                infoGrid.innerHTML = `
                    <div class="info-item">
                        <div class="info-icon">ğŸ‘¤</div>
                        <div class="info-content">
                            <div class="info-label">ë©˜í†  ì´ë¦„</div>
                            <div class="info-value">${mentorInfo.name}</div>
                        </div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-icon">ğŸ¢</div>
                        <div class="info-content">
                            <div class="info-label">ì—°ìˆ˜ì›</div>
                            <div class="info-value">${centerName}</div>
                        </div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-icon">ğŸ‘¥</div>
                        <div class="info-content">
                            <div class="info-label">ë‹´ë‹¹ ë¶„ê³¼</div>
                            <div class="info-value">${mentorInfo.teamNumber}ë¶„ê³¼ (${mentorInfo.mentees.length}ëª…)</div>
                        </div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-icon">ğŸ“…</div>
                        <div class="info-content">
                            <div class="info-label">ì„¤ì •ì¼</div>
                            <div class="info-value">${new Date(mentorInfo.setupDate).toLocaleDateString('ko-KR')}</div>
                        </div>
                    </div>
                `;
            } else {
                // ë©˜í†  ì •ë³´ê°€ ì—†ëŠ” ê²½ìš°
                infoGrid.innerHTML = `
                    <div class="info-item">
                        <div class="info-icon">âš ï¸</div>
                        <div class="info-content">
                            <div class="info-label">ë©˜í†  ì •ë³´</div>
                            <div class="info-value">ì„¤ì •ë˜ì§€ ì•ŠìŒ</div>
                        </div>
                    </div>
                `;
            }
        }

        function getCenterDisplayName(centerId) {
            const centers = {
                'icheon': 'ì´ì²œ SKTì¸ì¬ê°œë°œì›',
                'yongin': 'ìš©ì¸ SKì•„ì¹´ë°ë¯¸',
                'incheon': 'ì¸ì²œ SKë¬´ì˜ì—°ìˆ˜ì›',
                'sunning' : 'ì¨ë‹ ë¦¬ë”ì‹­ì„¼í„°',
                'sbti': 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ì—°ìˆ˜ì›'
            };
            return centers[centerId] || centerId;
        }

        function editMentorInfo() {
            closeMyPage();
            // ê¸°ì¡´ ë©˜í†  ì„¤ì • í¼ ì—´ê¸°
            if (mentorTeamManager) {
                mentorTeamManager.showMentorSetupForm();
            } else {
                alert('ë©˜í†  ì •ë³´ ì„¤ì • ê¸°ëŠ¥ì„ ì´ˆê¸°í™”í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.');
            }
        }
        
        function closeMentorSetupModal() {
            const modals = document.querySelectorAll('div[style*="position: fixed"]');
            modals.forEach(modal => {
                if (modal.innerHTML.includes('ë©˜í†  ì •ë³´ ì„¤ì •')) {
                    modal.remove();
                }
            });
        }

        function goToAttendance() {
            setActiveNav(2);
            window.location.href = 'guides/attendance.html';
        }

        function openSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            
            if (sidebar && overlay) {
                sidebar.classList.add('open');
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            
            if (sidebar && overlay) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
                document.body.style.overflow = '';
            }
        }

        function setActiveNav(index) {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach((item, i) => {
                if (i === index) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }

        function changeTrainingCenter() {
            if (confirm('ì—°ìˆ˜ì›ì„ ë‹¤ì‹œ ì„ íƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                // ì—°ìˆ˜ì› ì •ë³´ë§Œ ì œê±° (setupCompletedëŠ” ìœ ì§€)
                localStorage.removeItem('selectedCenter');
                closeSidebar();
                window.location.href = 'setup.html';
            } else {
                closeSidebar();
            }
        }

        function showAppInfo() {            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.7);
                z-index: 10000;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: white;
                    border-radius: 16px;
                    padding: 24px;
                    max-width: 400px;
                    width: 100%;
                    text-align: center;
                    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
                ">
                    <h2 style="color: #1976d2; margin-bottom: 16px;">â„¹ï¸ ì•± ì •ë³´</h2>
                    <div style="text-align: left; line-height: 1.6; margin-bottom: 20px;">
                        <p><strong>ì•± ì´ë¦„:</strong> SK ì‹ ì…êµ¬ì„±ì› ë©˜í†  ê°€ì´ë“œ</p>
                        <p><strong>ë²„ì „:</strong> 1.1.0</p>
                        <p><strong>ì—…ë°ì´íŠ¸:</strong> 2025.06.28</p>
                        <p><strong>ê°œë°œ:</strong> SKì•„ì¹´ë°ë¯¸ ìµœìœ í˜„ RF</p>
                        <hr style="margin: 12px 0; border: 1px solid #eee;">
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" 
                            style="
                                background: #1976d2;
                                color: white;
                                border: none;
                                padding: 12px 24px;
                                border-radius: 8px;
                                font-weight: 600;
                                cursor: pointer;
                            ">
                        í™•ì¸
                    </button>
                </div>
            `;
            
            document.body.appendChild(modal);
            closeSidebar();
        }

        // ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function requestMobilePushPermission() {
            console.log('ğŸ”” í˜„ì¬ ì•Œë¦¼ ê¶Œí•œ ìƒíƒœ:', Notification.permission);
            
            // ì´ë¯¸ ì°¨ë‹¨ëœ ìƒíƒœë¼ë©´
            if (Notification.permission === 'denied') {
                alert('ì•Œë¦¼ì´ ì°¨ë‹¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\n\nì‚¼ì„± ì¸í„°ë„· â†’ ì£¼ì†Œì°½ ìë¬¼ì‡  ì•„ì´ì½˜ â†’ ê¶Œí•œ â†’ ì•Œë¦¼ í—ˆìš©ìœ¼ë¡œ ë³€ê²½í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì´ë¯¸ í—ˆìš©ëœ ìƒíƒœë¼ë©´
            if (Notification.permission === 'granted') {
                alert('ì•Œë¦¼ì´ ì´ë¯¸ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤!');
                return;
            }
            
            // ê¶Œí•œ ìš”ì²­
            if (mobilePushManager) {
                mobilePushManager.requestPermission();
            }
        }

        function hideNotificationBanner() {
            if (mobilePushManager) {
                mobilePushManager.hideNotificationBanner();
            }
        }

        function toggleMobilePushNotifications() {
            closeSidebar();
            
            if (!mobilePushManager) {
                alert('ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ ì‹œìŠ¤í…œì´ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (mobilePushManager.permission === 'granted' && mobilePushManager.pushSubscription) {
                if (confirm('ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ì´ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\n\nì•Œë¦¼ì„ ë¹„í™œì„±í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    mobilePushManager.unsubscribe().then(success => {
                        if (success) {
                            mobilePushManager.showToast('ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
                        }
                    });
                }
            } else if (mobilePushManager.permission === 'denied') {
                alert('ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ì´ ì°¨ë‹¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\n\në¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ ì•Œë¦¼ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.');
            } else {
                mobilePushManager.requestPermission();
            }
        }


        // ì´ˆê¸°í™”
        // ëª¨ë“  ì´ˆê¸°í™”ë¥¼ í•˜ë‚˜ë¡œ í†µí•©
        document.addEventListener('DOMContentLoaded', function() {
            // 1. ê¸°ë³¸ ì´ˆê¸°í™”
            checkAttendanceStatus();
            
            // 2. ë§¤ë‹ˆì € ì´ˆê¸°í™”
            mentorTeamManager = new MentorTeamManager();
            mobilePushManager = new MobilePushNotificationManager();
            
            // 3. ì—°ìˆ˜ì› ì´ë¦„ ì„¤ì •
            try {
                const centerName = configManager.getCurrentConfig().centerName || "ì•Œ ìˆ˜ ì—†ìŒ";
                const centerNameEl = document.getElementById("center-name");
                if (centerNameEl) centerNameEl.textContent = centerName;
            } catch (e) {
                console.warn("ì—°ìˆ˜ì› ì´ë¦„ ë¡œë”© ì‹¤íŒ¨:", e);
                const centerNameEl = document.getElementById("center-name");
                if (centerNameEl) centerNameEl.textContent = "ë¯¸ì„¤ì •";
            }
            
            // 4. ë©”ë‰´ í† ê¸€ (ì¤‘ë³µ ì œê±°)
            const menuToggle = document.getElementById("menu-toggle");
            const sideMenu = document.getElementById("side-menu");
            if (menuToggle && sideMenu) {
                menuToggle.addEventListener("click", () => {
                    sideMenu.classList.toggle("open");
                });
            }
            
            // 5. ì—°ìˆ˜ì› ë³€ê²½ ë²„íŠ¼
            const changeCenterBtn = document.getElementById("change-center-btn");
            if (changeCenterBtn) {
                changeCenterBtn.addEventListener("click", () => {
                    if (confirm("ì—°ìˆ˜ì›ì„ ë‹¤ì‹œ ì„ íƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                        localStorage.removeItem("selectedCenter");
                        localStorage.removeItem("setupCompleted");
                        window.location.href = "setup.html";
                    }
                });
            }
            
            // 6. í•´ì‹œ ìŠ¤í¬ë¡¤ (ë¹ ì§„ ë¶€ë¶„ ì¶”ê°€!)
            const targetId = window.location.hash.substring(1);
            if (targetId) {
                const el = document.getElementById(targetId);
                if (el) {
                    setTimeout(() => {
                        el.scrollIntoView({ behavior: "smooth" });
                    }, 200);
                }
            }
            
            // 7. ëª¨ë‹¬ ì´ë²¤íŠ¸
            const myPageModal = document.getElementById('myPageModal');
            if (myPageModal) {
                myPageModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeMyPage();
                    }
                });
            }
            
            // 8. í‚¤ë³´ë“œ ì´ë²¤íŠ¸ (ESC)
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    const sidebar = document.querySelector('.sidebar');
                    if (sidebar && sidebar.classList.contains('open')) {
                        closeSidebar();
                        return;
                    }
                    closeMyPage();
                }
            });
            
            // 9. ë’¤ë¡œê°€ê¸° ì œì–´
            // ë’¤ë¡œê°€ê¸° ì œì–´ (í•œ ë²ˆë§Œ!)
            history.pushState(null, null, window.location.href);
            
            window.addEventListener('popstate', function(event) {
                const sidebar = document.querySelector('.sidebar');
                const modal = document.getElementById('myPageModal');
                
                // 1. ì‚¬ì´ë“œë°”ê°€ ì—´ë ¤ìˆìœ¼ë©´ ì‚¬ì´ë“œë°” ë‹«ê¸°
                if (sidebar && sidebar.classList.contains('open')) {
                    closeSidebar();
                    history.pushState(null, null, window.location.href);
                    return;
                }
                
                // 2. ë§ˆì´í˜ì´ì§€ ëª¨ë‹¬ì´ ì—´ë ¤ìˆìœ¼ë©´ ëª¨ë‹¬ ë‹«ê¸°  
                if (modal && modal.classList.contains('active')) {
                    closeMyPage();
                    history.pushState(null, null, window.location.href);
                    return;
                }
                
                // 3. ë‘˜ ë‹¤ ë‹«í˜€ìˆìœ¼ë©´ ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŒ (ì•± ì¢…ë£Œ ë°©ì§€)
                history.pushState(null, null, window.location.href);
            });
        });
            
            // 10. ì •ê¸° ì—…ë°ì´íŠ¸
            setInterval(updateTime, 60000);
            setInterval(() => {
                checkAttendanceStatus();
                if (mentorTeamManager) {
                    mentorTeamManager.updateInterviewStatus();
                }
            }, 300000);
            setInterval(() => {
                if (mobilePushManager) {
                    mobilePushManager.scheduleAutomaticNotifications();
                }
            }, 60000);
            
            // 11. ì‹œì‘ ì•Œë¦¼
            setTimeout(() => {
                showNotification('í™˜ì˜í•©ë‹ˆë‹¤!', 'ì˜¤ëŠ˜ì˜ ë©˜í†  ì—…ë¬´ë¥¼ ì‹œì‘í•´ì£¼ì„¸ìš”.');
            }, 1000);

        // í˜ì´ì§€ê°€ í¬ì»¤ìŠ¤ë  ë•Œë§ˆë‹¤ ì—…ë°ì´íŠ¸ (ë‹¤ë¥¸ í˜ì´ì§€ì—ì„œ ëŒì•„ì˜¬ ë•Œ)
            window.addEventListener('focus', function() {
                if (mentorTeamManager) {
                    mentorTeamManager.updateInterviewStatus();
                }
            });
            
            // í˜ì´ì§€ ë¡œë“œ ì‹œì—ë„ ì—…ë°ì´íŠ¸
            window.addEventListener('load', function() {
                setTimeout(() => {
                    if (mentorTeamManager) {
                        mentorTeamManager.updateInterviewStatus();
                    }
                }, 1000);
            });

        // í˜ì´ì§€ê°€ ë‹¤ì‹œ í¬ì»¤ìŠ¤ë  ë•Œ ì¶œì„ì²´í¬ ìƒíƒœ ì—…ë°ì´íŠ¸
            window.addEventListener('focus', function() {
                console.log('í˜ì´ì§€ í¬ì»¤ìŠ¤ - ì¶œì„ì²´í¬ ìƒíƒœ ì—…ë°ì´íŠ¸');
                checkAttendanceStatus();
            });
            
            window.addEventListener('pageshow', function(event) {
                if (event.persisted) {
                    // ë¸Œë¼ìš°ì € ìºì‹œì—ì„œ í˜ì´ì§€ê°€ ë³µì›ëœ ê²½ìš°
                    console.log('ìºì‹œì—ì„œ í˜ì´ì§€ ë³µì› - ì¶œì„ì²´í¬ ìƒíƒœ ì—…ë°ì´íŠ¸');
                    checkAttendanceStatus();
                }
            });

        // ê°œë³„ í•¨ìˆ˜ë“¤
        function scrollToToday() {
            const todaySection = document.getElementById("today-schedule");
            if (todaySection) todaySection.scrollIntoView({ behavior: "smooth" });
        }

        function closeMenu() {
            const sideMenu = document.getElementById("side-menu");
            if (sideMenu) sideMenu.classList.remove("open");
        }
    </script>


<!-- ğŸ”„ ê¸°ì¡´ ì‚¬ì´ë“œë°”ë¥¼ ì´ê²ƒìœ¼ë¡œ ì „ì²´ êµì²´ -->
<div class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <div class="sidebar-title">ğŸ¯ ë©˜í†  ê°€ì´ë“œ ëª¨ìŒ</div>
        <div class="sidebar-subtitle">ë©˜í† ë¥¼ ìœ„í•œ A to Z</div>
        <button class="sidebar-close" onclick="closeSidebar()">Ã—</button>
    </div>
    
    <div class="sidebar-content">
        <!-- í•µì‹¬ í”„ë¡œê·¸ë¨ -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">
                ğŸ¯ í•µì‹¬ í”„ë¡œê·¸ë¨
            </div>
            
            <a href="guides/vision-building.html" class="sidebar-menu-item">
                <div class="menu-icon">ğŸ¯</div>
                <div class="menu-text">
                    <div class="menu-title">Vision Building</div>
                    <div class="menu-desc">ìê¸°ì†Œê°œ & íŒ€ë¹Œë”©</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </a>

            <a href="guides/daily-opening.html" class="sidebar-menu-item">
                <div class="menu-icon">ğŸŒ…</div>
                <div class="menu-text">
                    <div class="menu-title">Daily Opening</div>
                    <div class="menu-desc">ë§¤ì¼ ì§„í–‰í•˜ëŠ” ì˜¤í”„ë‹</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </a>
                        
            <a href="guides/interview.html" class="sidebar-menu-item">
                <div class="menu-icon">ğŸ’¬</div>
                <div class="menu-text">
                    <div class="menu-title">1:1 ë©´ë‹´</div>
                    <div class="menu-desc">ì§ˆë¬¸ ì˜ˆì‹œ & ëŒ€ì‘ë²•</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </a>

            
        </div>

        <!-- ê°€ì´ë“œ ëª¨ìŒ -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">
                ğŸ“š ìœ ìš©í•œ ê°€ì´ë“œ
            </div>
            
            <a href="guides/memorial-tour.html" class="sidebar-menu-item">
                <div class="menu-icon">ğŸ›ï¸</div>
                <div class="menu-text">
                    <div class="menu-title">ê¸°ë…ê´€ Tour</div>
                    <div class="menu-desc">ìŠ¤í† ë¦¬í…”ë§ ìŠ¤í¬ë¦½íŠ¸</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </a>
            
            <a href="guides/play-skms.html" class="sidebar-menu-item">
                <div class="menu-icon">ğŸ®</div>
                <div class="menu-text">
                    <div class="menu-title">Play SKMS</div>
                    <div class="menu-desc">SKMS ê²Œì„ ê´€ì°°ë²•</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </a>

            <a href="guides/growth-roadmap.html" class="sidebar-menu-item">
                <div class="menu-icon">ğŸ“ˆ</div>
                <div class="menu-text">
                    <div class="menu-title">ì„±ì¥ Roadmap</div>
                    <div class="menu-desc">ê°•ì  ê¸°ë°˜ ë¡œë“œë§µ</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </a>
            

        </div>

        <!-- ğŸ†• ìƒí™œ ê°€ì´ë“œ ì„¹ì…˜ ì¶”ê°€ -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">
                ğŸ“– ìƒí™œ ê°€ì´ë“œ
            </div>
            
            <a href="guides/mentor-principles.html" class="sidebar-menu-item">
                <div class="menu-icon">ğŸ’¡</div>
                <div class="menu-text">
                    <div class="menu-title">ë©˜í†  í•µì‹¬ ì›ì¹™</div>
                    <div class="menu-desc">Do & Don'ts ê°€ì´ë“œë¼ì¸</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </a>
            
            <a href="guides/mentor-life-guide.html" class="sidebar-menu-item">
                <div class="menu-icon">ğŸ‘¨â€ğŸ«</div>
                <div class="menu-text">
                    <div class="menu-title">ë©˜í†  ìƒí™œ ë°±ì„œ</div>
                    <div class="menu-desc">ìˆ™ì†Œ, ë¯¸íŒ…, ì´ë™ ì•ˆë‚´</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </a>
            
            <a href="guides/trainee-life-guide.html" class="sidebar-menu-item">
                <div class="menu-icon">ğŸ‘¥</div>
                <div class="menu-text">
                    <div class="menu-title">ì‹ ì…êµ¬ì„±ì› ìƒí™œ ë°±ì„œ</div>
                    <div class="menu-desc">ê¸ˆê¸°ì‚¬í•­ & ê·œìœ¨ ì•ˆë‚´</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </a>
            
            <a href="guides/facility-guide.html" class="sidebar-menu-item">
                <div class="menu-icon">ğŸ¢</div>
                <div class="menu-text">
                    <div class="menu-title">ì—°ìˆ˜ì› ì´ìš© ì•ˆë‚´</div>
                    <div class="menu-desc">ì‹œì„¤ ìœ„ì¹˜ & ì´ìš© ë°©ë²•</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </a>
            
            <a href="guides/mysuni-community.html" class="sidebar-menu-item">
                <div class="menu-icon">ğŸŒ</div>
                <div class="menu-text">
                    <div class="menu-title">mySUNI ì»¤ë®¤ë‹ˆí‹°</div>
                    <div class="menu-desc">ì˜¨ë¼ì¸ í”Œë«í¼ í™œìš©ë²•</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </a>
        </div>

        <!-- ğŸ†• ì •ë³´ & ì—°ë½ì²˜ ì„¹ì…˜ ì¶”ê°€ -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">
                ğŸ“ ì •ë³´ & ì—°ë½ì²˜
            </div>
            
            <a href="guides/emergency-contacts.html" class="sidebar-menu-item">
                <div class="menu-icon">ğŸš¨</div>
                <div class="menu-text">
                    <div class="menu-title">ê¸´ê¸‰ ì—°ë½ì²˜</div>
                    <div class="menu-desc">ì‘ê¸‰ìƒí™© ëŒ€ì‘ ê°€ì´ë“œ</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </a>
        </div>

        <!-- ì„¤ì • ë° ì •ë³´ (ê¸°ì¡´) -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">
                âš™ï¸ ì„¤ì • & ì•± ì •ë³´
            </div>
            
            <button class="sidebar-menu-item" onclick="openMyPage(); closeSidebar();">
                <div class="menu-icon">ğŸ‘¤</div>
                <div class="menu-text">
                    <div class="menu-title">ë©˜í†  ì •ë³´ ìˆ˜ì •</div>
                    <div class="menu-desc">ì´ë¦„, ë¶„ê³¼, ë©˜í‹° ê´€ë¦¬</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </button>
            
            <button class="sidebar-menu-item" onclick="changeTrainingCenter()">
                <div class="menu-icon">ğŸ¢</div>
                <div class="menu-text">
                    <div class="menu-title">ì—°ìˆ˜ì› ë³€ê²½</div>
                    <div class="menu-desc">ë‹¤ë¥¸ ì—°ìˆ˜ì›ìœ¼ë¡œ ë³€ê²½</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </button>
            
            <button class="sidebar-menu-item" onclick="toggleMobilePushNotifications()">
                <div class="menu-icon">ğŸ””</div>
                <div class="menu-text">
                    <div class="menu-title">ì•Œë¦¼ ì„¤ì •</div>
                    <div class="menu-desc" id="notificationToggleDesc">ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼ ê´€ë¦¬</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </button>
            
            <button class="sidebar-menu-item" onclick="showAppInfo()">
                <div class="menu-icon">â„¹ï¸</div>
                <div class="menu-text">
                    <div class="menu-title">ì•± ì •ë³´</div>
                    <div class="menu-desc">ë²„ì „, ì—…ë°ì´íŠ¸ ë‚´ì—­</div>
                </div>
                <div class="menu-arrow">â†’</div>
            </button>
        </div>
    </div>
</div>

<!-- ğŸ†• ì‚¬ì´ë“œë°” ì˜¤ë²„ë ˆì´ ì¶”ê°€ (ê¸°ì¡´ ì‚¬ì´ë“œë°” ë‹¤ìŒì—) -->
<div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>


<!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
<nav class="bottom-nav">
    <button class="nav-item active" onclick="goToHome()">
        <div class="nav-icon">ğŸ </div>
        <div class="nav-label">í™ˆ</div>
    </button>
    
    <button class="nav-item" onclick="openMyPage()">
        <div class="nav-icon">ğŸ‘¤</div>
        <div class="nav-label">ë‚´ì •ë³´</div>
    </button>
    
    <button class="nav-item" onclick="goToAttendance()">
        <div class="nav-icon">ğŸ“‹</div>
        <div class="nav-label">ì¶œì„ì²´í¬</div>
        <div class="nav-badge" id="attendanceBadge" style="display: none;">2</div>
    </button>
    
    <button class="nav-item" onclick="openSidebar()">
        <div class="nav-icon">â˜°</div>
        <div class="nav-label">ë©”ë‰´</div>
    </button>
</nav>


<!-- ğŸ†• ë§ˆì´ í˜ì´ì§€ ëª¨ë‹¬ -->
<div class="my-page-modal" id="myPageModal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title">ğŸ‘¤ ë©˜í†  ì •ë³´</div>
            <div class="modal-subtitle">í˜„ì¬ ì„¤ì •ëœ ë©˜í†  ì •ë³´ì…ë‹ˆë‹¤</div>
            <button class="modal-close" onclick="closeMyPage()">Ã—</button>
        </div>
        
        <div class="my-info-grid" id="myInfoGrid">
            <!-- JavaScriptê°€ ë™ì ìœ¼ë¡œ ìƒì„± -->
        </div>
        
        <div class="modal-actions">
            <button class="modal-btn btn-primary" onclick="editMentorInfo()">
                ì •ë³´ ìˆ˜ì •
            </button>
            <button class="modal-btn btn-secondary" onclick="closeMyPage()">
                ë‹«ê¸°
            </button>
        </div>
    </div>
</div>
</body>
</html> 
