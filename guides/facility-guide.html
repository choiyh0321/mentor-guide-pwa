<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè¢ Ïó∞ÏàòÏõê Ïù¥Ïö© ÏïàÎÇ¥</title>
    <meta name="theme-color" content="#EA1917">
    
    <script>
        function goBack() {
            try {
                if (window.history.length > 1) {
                    window.history.back();
                    return;
                }
            } catch (e) {
                console.log('history.back() Ïã§Ìå®:', e);
            }

            try {
                const currentUrl = window.location.href;
                const parentUrl = currentUrl.substring(0, currentUrl.lastIndexOf('/'));
                if (parentUrl && parentUrl !== currentUrl) {
                    window.location.href = parentUrl;
                    return;
                }
            } catch (e) {
                console.log('ÏÉÅÏúÑ Ìè¥Îçî Ïù¥Îèô Ïã§Ìå®:', e);
            }

            try {
                window.location.href = '../index.html';
            } catch (e) {
                console.log('index.html Ïù¥Îèô Ïã§Ìå®:', e);
                window.open('../index.html', '_blank');
            }
        }
    </script>

    <style>
        :root {
            --sk-red: #EA1917;
            --sk-orange: #FF6B35;
            --success: #4CAF50;
            --warning: #FF9800;
            --info: #2196F3;
            --purple: #9C27B0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #fafafa 0%, #f0f0f0 100%);
            color: #333;
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, var(--success) 0%, var(--info) 100%);
            color: white;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .header-content {
            position: relative;
            z-index: 10;
            text-align: center;
        }

        .back-btn {
            position: absolute;
            left: 0;
            top: 0;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            z-index: 9999;
        }

        .title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .subtitle {
            opacity: 0.9;
            font-size: 14px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .loading-indicator {
            text-align: center;
            padding: 40px;
            background: rgba(255,255,255,0.9);
            border-radius: 20px;
            margin-bottom: 20px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f0f0f0;
            border-top: 4px solid var(--success);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .data-source-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .source-google {
            background: rgba(76, 175, 80, 0.1);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .source-cache {
            background: rgba(255, 152, 0, 0.1);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        .source-default {
            background: rgba(156, 39, 176, 0.1);
            color: var(--purple);
            border: 1px solid var(--purple);
        }

        .center-info-card {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.06);
            text-align: center;
            border-left: 4px solid var(--success);
        }

        .center-icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        .center-name {
            font-size: 20px;
            font-weight: 600;
            color: var(--success);
            margin-bottom: 8px;
        }

        .center-address {
            font-size: 14px;
            color: #666;
            user-select: text;
        }

        .info-section {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.06);
            border-left: 4px solid var(--success);
        }

        .info-section.my-team {
            border-left-color: var(--sk-red);
        }

        .info-section.facilities {
            border-left-color: var(--info);
        }

        .info-section.amenities {
            border-left-color: var(--warning);
        }

        .info-section.contact {
            border-left-color: var(--purple);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--success);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-section.my-team .section-title {
            color: var(--sk-red);
        }

        .info-section.facilities .section-title {
            color: var(--info);
        }

        .info-section.amenities .section-title {
            color: var(--warning);
        }

        .info-section.contact .section-title {
            color: var(--purple);
        }

        .team-badge {
            display: inline-block;
            background: var(--sk-red);
            color: white;
            padding: 8px 16px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .map-container {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            min-height: 250px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 2px dashed #ddd;
        }

        /* Ïù¥ÎØ∏ÏßÄÍ∞Ä ÏûàÏùÑ Îïå Ïä§ÌÉÄÏùº Î≥ÄÍ≤Ω */
        .map-container img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 12px;
        }

        /* Ïù¥ÎØ∏ÏßÄÍ∞Ä ÏûàÏùÑ ÎïåÎäî Ï†êÏÑ† ÌÖåÎëêÎ¶¨ Ï†úÍ±∞ */
        .map-container:has(img) {
            border: 1px solid rgba(255,255,255,0.2);
        }

        .map-placeholder {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 12px;
        }

        .map-highlight {
            background: rgba(234, 25, 23, 0.1);
            border: 1px solid var(--sk-red);
            border-radius: 8px;
            padding: 8px 16px;
            font-weight: 600;
            color: #c62828;
            font-size: 14px;
        }


        .facility-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 16px;
        }

        .facility-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .facility-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            background: rgba(255, 255, 255, 0.9);
        }

        .facility-icon {
            font-size: 24px;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .facility-content {
            flex: 1;
        }

        .facility-name {
            font-weight: 600;
            margin-bottom: 4px;
            color: #333;
            user-select: text;
        }

        .facility-info {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
            user-select: text;
        }

        .facility-hours {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid var(--success);
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 13px;
            color: #2e7d32;
            font-weight: 500;
        }

        .facility-note {
            background: rgba(255, 152, 0, 0.1);
            border: 1px solid var(--warning);
            border-radius: 8px;
            padding: 8px 12px;
            margin-top: 8px;
            font-size: 13px;
            color: #e65100;
        }

        .contact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .contact-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.2);
            background: rgba(255, 255, 255, 0.9);
        }

        .contact-icon {
            font-size: 24px;
            color: var(--purple);
            flex-shrink: 0;
        }

        .contact-details {
            flex: 1;
        }

        .contact-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .contact-phone {
            font-size: 14px;
            color: var(--purple);
            font-weight: 500;
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 16px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 10000;
            animation: slideInRight 0.3s ease;
        }

        .toast.success {
            background: var(--success);
        }

        .toast.warning {
            background: var(--warning);
        }

        .toast.error {
            background: #f44336;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 16px;
            }

            .info-section {
                padding: 20px;
                margin-bottom: 16px;
            }

            .title {
                font-size: 20px;
            }

            .map-container img {
                border-radius: 4px;
            }

            .facility-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .contact-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .facility-item {
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <button class="back-btn" onclick="goBack()">‚Üê Îí§Î°úÍ∞ÄÍ∏∞</button>
            <div class="title">üè¢ Ïó∞ÏàòÏõê Ïù¥Ïö© ÏïàÎÇ¥</div>
            <div class="subtitle">ÏãúÏÑ§ ÏúÑÏπò Î∞è Ïù¥Ïö© Î∞©Î≤ï Í∞ÄÏù¥Îìú</div>
        </div>
    </div>

    <div class="container">
        <!-- Î°úÎî© Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ -->
        <div class="loading-indicator" id="loading">
            <div class="loading-spinner"></div>
            <div>Ïó∞ÏàòÏõê Ï†ïÎ≥¥Î•º Î∂àÎü¨Ïò§Îäî Ï§ë...</div>
        </div>

        <!-- ÌòÑÏû¨ ÏÑ†ÌÉùÎêú Ïó∞ÏàòÏõê Ï†ïÎ≥¥ + ÎÇ¥ Î∂ÑÍ≥º Ï†ïÎ≥¥ -->
        <div class="center-info-card" id="center-info" style="display: none;">
            <!-- Ïó∞ÏàòÏõê Ï†ïÎ≥¥Í∞Ä ÎèôÏ†ÅÏúºÎ°ú Î°úÎìúÎê©ÎãàÎã§ -->
        </div>

        <!-- Ï†ÑÏ≤¥ Îßµ -->
        <div class="info-section facilities" id="map-section" style="display: none;">
            <div class="section-title">
                <span>üó∫Ô∏è</span>
                Ïó∞ÏàòÏõê Ï†ÑÏ≤¥ Îßµ
            </div>
            
            <div class="map-container">
                <div class="map-placeholder">
                    üìç Ïó∞ÏàòÏõê Í±¥Î¨º Î∞∞ÏπòÎèÑ
                    <div style="font-size: 0.9em; margin-top: 8px; opacity: 0.7;">
                        (Ïã§Ï†ú Íµ¨ÌòÑ Ïãú Ïù∏ÌÑ∞ÎûôÌã∞Î∏å Îßµ ÎòêÎäî Ïù¥ÎØ∏ÏßÄ)
                    </div>
                </div>
                <div class="map-highlight" id="map-highlight">
                    ÎÇ¥ ÏúÑÏπòÎ•º ÌôïÏù∏ Ï§ë...
                </div>
            </div>
        </div>

        <!-- Ìé∏ÏùòÏãúÏÑ§ Ïù¥Ïö©ÏïàÎÇ¥ -->
        <div class="info-section amenities" id="amenities-section" style="display: none;">
            <div class="section-title">
                <span>üéØ</span>
                Ìé∏ÏùòÏãúÏÑ§ ÏïàÎÇ¥
            </div>
            
            <div class="facility-grid" id="amenities-grid">
                <!-- Ìé∏ÏùòÏãúÏÑ§ Ï†ïÎ≥¥Í∞Ä ÎèôÏ†ÅÏúºÎ°ú Î°úÎìúÎê©ÎãàÎã§ -->
            </div>
        </div>

        <!-- Ïó∞ÎùΩÏ≤ò Ï†ïÎ≥¥ -->
        <div class="info-section contact" id="contact-section" style="display: none;">
            <div class="section-title">
                <span>üìû</span>
                Ïó∞ÏàòÏõê Ïó∞ÎùΩÏ≤ò
            </div>
            
            <div class="contact-grid" id="contact-list">
                <!-- Ïó∞ÎùΩÏ≤òÍ∞Ä ÎèôÏ†ÅÏúºÎ°ú Î°úÎìúÎê©ÎãàÎã§ -->
            </div>
        </div>
    </div>

    <script>
        // =====================================================
        // Íµ¨Í∏Ä ÏãúÌä∏ Ïó∞Îèô Í¥ÄÎ¶¨ ÌÅ¥ÎûòÏä§
        // =====================================================
        class FacilityDataManager {
            constructor() {
                this.APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyvkEufshC8wwQwMqO5nJsdhhUC6EvBqKkeXVR5YF5cQnnPLUG3oo5d0eObTVkjN55Y/exec';
            }

            // SetupÏóêÏÑú Ïó∞ÏàòÏõê Î∞è Î∂ÑÍ≥º Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞
            getSetupInfo() {
                try {
                    // sk-mentor-info Ïö∞ÏÑ† ÌôïÏù∏
                    const mentorInfo = localStorage.getItem('sk-mentor-info');
                    if (mentorInfo && mentorInfo !== 'null') {
                        const parsed = JSON.parse(mentorInfo);
                        if (parsed.trainingCenter && parsed.teamNumber) {
                            console.log('‚úÖ sk-mentor-infoÏóêÏÑú Î∞úÍ≤¨:', parsed.trainingCenter, parsed.teamNumber);
                            return {
                                trainingCenter: parsed.trainingCenter.toLowerCase(),
                                teamNumber: parseInt(parsed.teamNumber)
                            };
                        }
                    }
                    
                    // Î∞©Î≤ï 1: ÏßÅÏ†ë Ï†ÄÏû•Îêú Í∞í ÌôïÏù∏
                    const selectedCenter = localStorage.getItem('selectedCenter');
                    console.log('üìã selectedCenter Í∞í:', selectedCenter);
                    
                    let trainingCenter = null;
                    let teamNumber = null; // Í∏∞Î≥∏Í∞íÏùÑ nullÎ°ú Î≥ÄÍ≤Ω
                    
                    if (selectedCenter && selectedCenter !== 'null' && selectedCenter !== '') {
                        trainingCenter = selectedCenter;
                        console.log('‚úÖ selectedCenterÏóêÏÑú Ïó∞ÏàòÏõê Ï†ïÎ≥¥ Î∞úÍ≤¨:', selectedCenter);
                    } else {
                        // Î∞©Î≤ï 2: Í∏∞Ï°¥ setupData ÌôïÏù∏
                        const setupData = localStorage.getItem('mentorSetup');
                        console.log('üìã mentorSetup ÏõêÎ≥∏ Îç∞Ïù¥ÌÑ∞:', setupData);
                        
                        if (setupData && setupData !== 'null') {
                            const setup = JSON.parse(setupData);
                            console.log('üìä ÌååÏã±Îêú setup Í∞ùÏ≤¥:', setup);
                            
                            if (setup.trainingCenter) {
                                trainingCenter = setup.trainingCenter;
                                console.log('‚úÖ mentorSetupÏóêÏÑú Ïó∞ÏàòÏõê Ï†ïÎ≥¥ Î∞úÍ≤¨:', setup.trainingCenter);
                            }
                            
                            if (setup.teamNumber) {
                                teamNumber = setup.teamNumber;
                                console.log('‚úÖ mentorSetupÏóêÏÑú Î∂ÑÍ≥º Ï†ïÎ≥¥ Î∞úÍ≤¨:', setup.teamNumber);
                            }
                        }
                    }
                    
                    if (!trainingCenter) {
                        console.log('‚ö†Ô∏è SetupÏóêÏÑú Ïó∞ÏàòÏõê Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏùå. Í∏∞Î≥∏Í∞í(icheon) ÏÇ¨Ïö©');
                        trainingCenter = 'icheon';
                    }
                    
                    return { trainingCenter, teamNumber };
                    
                } catch (e) {
                    console.error('‚ùå Setup Îç∞Ïù¥ÌÑ∞ ÏùΩÍ∏∞ Ïã§Ìå®:', e);
                    return { trainingCenter: 'icheon', teamNumber: null };
                }
            }

            // Íµ¨Í∏Ä ÏãúÌä∏ÏóêÏÑú Ïó∞ÏàòÏõê Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
            async fetchFromGoogleSheets() {
                try {
                    console.log('üîÑ Íµ¨Í∏Ä ÏãúÌä∏ Ïó∞Í≤∞ ÏãúÎèÑ...');
                    console.log('üì° ÏöîÏ≤≠ URL:', this.APPS_SCRIPT_URL + '?action=getTrainingCenters');
                    
                    const response = await fetch(this.APPS_SCRIPT_URL + '?action=getTrainingCenters', {
                        method: 'GET',
                        mode: 'cors',
                        headers: {
                            'Accept': 'application/json',
                        }
                    });
                    
                    console.log('üìä ÏùëÎãµ ÏÉÅÌÉú:', response.status, response.statusText);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    const responseText = await response.text();
                    console.log('üìÑ ÏõêÎ≥∏ ÏùëÎãµ ÌÖçÏä§Ìä∏:', responseText);
                    
                    const data = JSON.parse(responseText);
                    console.log('‚úÖ ÌååÏã±Îêú JSON Îç∞Ïù¥ÌÑ∞:', data);
                    
                    if (data.error) {
                        throw new Error(`Ïï±Ïä§ Ïä§ÌÅ¨Î¶ΩÌä∏ Ïò§Î•ò: ${data.error}`);
                    }
                    
                    return this.parseSheetData(data);
                    
                } catch (error) {
                    console.error('‚ùå Íµ¨Í∏Ä ÏãúÌä∏ Ïó∞Í≤∞ Ïã§Ìå®:', error);
                    return null;
                }
            }

            // ÏãúÌä∏ Îç∞Ïù¥ÌÑ∞ ÌååÏã±
            parseSheetData(data) {
                console.log('üîÑ ÏãúÌä∏ Îç∞Ïù¥ÌÑ∞ ÌååÏã± ÏãúÏûë...');
                const centers = {};
                
                if (!Array.isArray(data)) {
                    console.error('‚ùå Îç∞Ïù¥ÌÑ∞Í∞Ä Î∞∞Ïó¥Ïù¥ ÏïÑÎãò:', typeof data, data);
                    return null;
                }
                
                console.log(`üìä Ï¥ù ${data.length}Í∞ú Ìñâ Ï≤òÎ¶¨ ÏòàÏ†ï`);
                
                data.forEach((row, index) => {
                    try {
                        console.log(`üîç Ìñâ ${index + 1} Ï≤òÎ¶¨ Ï§ë:`, row);
                        
                        const {
                            er_id,
                            center_name,
                            address,
                            emergency_phone,
                            wifi_ssid,
                            wifi_password,
                            operations_name,
                            operations_phone,
                            mentor_support_name,
                            mentor_support_phone,
                            enabled
                        } = row;
                        
                        console.log(`  üìã er_id: ${er_id}, enabled: ${enabled}`);
                        
                        if (!er_id || enabled !== true) {
                            console.log(`  ‚è≠Ô∏è Ìñâ ${index + 1} Ïä§ÌÇµÎê® (er_id: ${er_id}, enabled: ${enabled})`);
                            return;
                        }
                        
                        centers[er_id] = {
                            name: center_name || this.getDefaultCenterName(er_id),
                            address: address || 'Ï£ºÏÜå Ï†ïÎ≥¥ ÏóÜÏùå',
                            wifi: {
                                ssid: wifi_ssid || 'Wi-Fi Ï†ïÎ≥¥ ÏóÜÏùå',
                                password: wifi_password || 'N/A'
                            },
                            contacts: [
                                {
                                    icon: "üë®‚Äçüíº",
                                    name: operations_name ? `Ïö¥ÏòÅÏßÑ ÎåÄÌëú (${operations_name})` : "Ïö¥ÏòÅÏßÑ ÎåÄÌëú",
                                    phone: operations_phone || 'N/A'
                                },
                                {
                                    icon: "üìã",
                                    name: mentor_support_name ? `Î©òÌÜ† ÏßÄÏõê (${mentor_support_name})` : "Î©òÌÜ† ÏßÄÏõê",
                                    phone: mentor_support_phone || 'N/A'
                                },
                                {
                                    icon: "üö®",
                                    name: "Ïó∞ÏàòÏõê Î¨∏Ïùò",
                                    phone: emergency_phone || 'N/A'
                                }
                            ]
                        };
                        
                        console.log(`  ‚úÖ ${er_id} Ïó∞ÏàòÏõê Îç∞Ïù¥ÌÑ∞ ÌååÏã± ÏôÑÎ£å`);
                        
                    } catch (parseError) {
                        console.error(`‚ùå Ìñâ ${index + 1} ÌååÏã± Ïã§Ìå®:`, parseError, row);
                    }
                });
                
                console.log('üéØ ÏµúÏ¢Ö ÌååÏã±Îêú Ïó∞ÏàòÏõê Îç∞Ïù¥ÌÑ∞:', centers);
                return centers;
            }

            async fetchFacilityMapping() {
                try {
                    const response = await fetch('https://script.google.com/macros/s/AKfycbyvkEufshC8wwQwMqO5nJsdhhUC6EvBqKkeXVR5YF5cQnnPLUG3oo5d0eObTVkjN55Y/exec?action=getfacilityMapping');
                    const json = await response.json();
                    
                    // Î∞∞Ïó¥ÏùÑ Í∞ùÏ≤¥Î°ú Î≥ÄÌôò
                    const mapping = {};
                    json.forEach(item => {
                        if (!mapping[item.center_id]) {
                            mapping[item.center_id] = {};
                        }
                        mapping[item.center_id][item.team_number] = {
                            lectureHall: item.lecture_hall,
                            teamRoom: item.team_room
                        };
                    });
                    
                    console.log('üìä Î≥ÄÌôòÎêú Î∂ÑÍ≥º Îß§Ìïë:', mapping);
                    return mapping;
                    
                } catch (error) {
                    console.warn('‚ùå facilityMapping Î°úÎìú Ïã§Ìå®:', error);
                    return null;
                }
            }


            // Í∏∞Î≥∏ Ïó∞ÏàòÏõê Ïù¥Î¶Ñ Í∞ÄÏ†∏Ïò§Í∏∞
            getDefaultCenterName(centerId) {
                const names = {
                    'icheon': 'Ïù¥Ï≤ú SKTÏù∏Ïû¨Í∞úÎ∞úÏõê',
                    'yongin': 'Ïö©Ïù∏ SKÏïÑÏπ¥Îç∞ÎØ∏',
                    'incheon': 'Ïù∏Ï≤ú SKÎ¨¥ÏùòÏó∞ÏàòÏõê'
                };
                return names[centerId] || `${centerId} Ïó∞ÏàòÏõê`;
            }

            // Ï∫êÏãúÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
            getFromCache() {
                try {
                    const cachedData = localStorage.getItem('facility-centers-backup');
                    const cacheTime = localStorage.getItem('facility-centers-backup-time');
                    
                    if (!cachedData) {
                        throw new Error('Ï∫êÏãú Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå');
                    }
                    
                    // Ï∫êÏãú ÎßåÎ£å ÌôïÏù∏ (5Î∂Ñ)
                    if (cacheTime && Date.now() - parseInt(cacheTime) > 5 * 60 * 1000) {
                        console.warn('‚è∞ Ï∫êÏãú Îç∞Ïù¥ÌÑ∞ ÎßåÎ£åÎê®');
                        // ÎßåÎ£åÎêòÏñ¥ÎèÑ Î∞òÌôò (Ïò§ÌîÑÎùºÏù∏ÏóêÏÑúÎäî Ïò§ÎûòÎêú Îç∞Ïù¥ÌÑ∞ÎùºÎèÑ Ïú†Ïö©)
                    }
                    
                    console.log('üíæ Ï∫êÏãúÏóêÏÑú Ïó∞ÏàòÏõê Îç∞Ïù¥ÌÑ∞ Î°úÎìú');
                    return JSON.parse(cachedData);
                    
                } catch (error) {
                    console.warn('‚ö†Ô∏è Ï∫êÏãú Î°úÎìú Ïã§Ìå®:', error.message);
                    return null;
                }
            }

            // Ï∫êÏãúÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            saveToCache(data) {
                try {
                    localStorage.setItem('facility-centers-backup', JSON.stringify(data));
                    localStorage.setItem('facility-centers-backup-time', Date.now().toString());
                    console.log('üíæ Ïó∞ÏàòÏõê Îç∞Ïù¥ÌÑ∞ Ï∫êÏãú Ï†ÄÏû• ÏôÑÎ£å');
                } catch (error) {
                    console.warn('‚ö†Ô∏è Ï∫êÏãú Ï†ÄÏû• Ïã§Ìå®:', error.message);
                }
            }

            // 3Îã®Í≥Ñ fallbackÏúºÎ°ú Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
            async getData() {
                try {
                    // 1Îã®Í≥Ñ: Íµ¨Í∏ÄÏãúÌä∏ÏóêÏÑú Í∞ÄÏ†∏Ïò§Í∏∞
                    console.log('üì° Íµ¨Í∏ÄÏãúÌä∏ÏóêÏÑú Ïó∞ÏàòÏõê Îç∞Ïù¥ÌÑ∞ ÏöîÏ≤≠...');
                    const sheetData = await this.fetchFromGoogleSheets();
                    
                    if (sheetData && Object.keys(sheetData).length > 0) {
                        console.log('‚úÖ Íµ¨Í∏ÄÏãúÌä∏ÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏÑ±Í≥µ');
                        this.saveToCache(sheetData);
                        return { data: sheetData, source: 'google' };
                    }
                    
                    throw new Error('Íµ¨Í∏ÄÏãúÌä∏ Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå');
                    
                } catch (error) {
                    console.warn(`‚ö†Ô∏è Íµ¨Í∏ÄÏãúÌä∏ Ïó∞Í≤∞ Ïã§Ìå®, Ï∫êÏãú ÌôïÏù∏ Ï§ë... (${error.message})`);
                    
                    try {
                        // 2Îã®Í≥Ñ: Ï∫êÏãúÏóêÏÑú Í∞ÄÏ†∏Ïò§Í∏∞
                        const cachedData = this.getFromCache();
                        if (cachedData && Object.keys(cachedData).length > 0) {
                            console.log('üíæ Ï∫êÏãúÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏÑ±Í≥µ');
                            return { data: cachedData, source: 'cache' };
                        }
                        
                        throw new Error('Ï∫êÏãú Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå');
                        
                    } catch (cacheError) {
                        console.warn(`‚ö†Ô∏è Ï∫êÏãúÎèÑ Ïã§Ìå®, Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©... (${cacheError.message})`);
                        
                        // 3Îã®Í≥Ñ: Í∏∞Î≥∏ ÌïòÎìúÏΩîÎî© Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
                        return { data: this.getDefaultData(), source: 'default' };
                    }
                }
            }

            // Í∏∞Î≥∏ ÌïòÎìúÏΩîÎî© Îç∞Ïù¥ÌÑ∞ (ÏµúÌõÑ ÏàòÎã®)
            getDefaultData() {
                console.log('üìÑ Í∏∞Î≥∏ ÌïòÎìúÏΩîÎî© Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©');
                return {
                    'icheon': {
                        name: 'Ïù¥Ï≤ú SKTÏù∏Ïû¨Í∞úÎ∞úÏõê',
                        address: 'Í≤ΩÍ∏∞ Ïù¥Ï≤úÏãú ÎßàÏû•Î©¥ ÏÑúÏù¥Ï≤úÎ°ú 481-28',
                        wifi: {
                            ssid: 'FMI',
                            password: 'Î¨∏Ïùò Ïãú ÏïàÎÇ¥'
                        },
                        contacts: [
                            { icon: "üë®‚Äçüíº", name: "Ïö¥ÏòÅÏßÑ ÎåÄÌëú", phone: "010-2360-1145" },
                            { icon: "üìã", name: "Î©òÌÜ† ÏßÄÏõê", phone: "010-9235-5562" },
                            { icon: "üö®", name: "Ï§ëÏïô ÌÜµÏ†úÏã§", phone: "031-630-8914" }
                        ]
                    },
                    'yongin': {
                        name: 'Ïö©Ïù∏ SKÏïÑÏπ¥Îç∞ÎØ∏',
                        address: 'Í≤ΩÍ∏∞ÎèÑ Ïö©Ïù∏Ïãú Ï≤òÏù∏Íµ¨ ÏõêÏÇºÎ©¥ Î™®ÎûòÏã§Î°ú 17',
                        wifi: {
                            ssid: 'SK_Academy',
                            password: 'Î¨∏Ïùò Ïãú ÏïàÎÇ¥'
                        },
                        contacts: [
                            { icon: "üë®‚Äçüíº", name: "Ïö¥ÏòÅÏßÑ ÎåÄÌëú", phone: "010-2386-2376" },
                            { icon: "üìã", name: "Î©òÌÜ† ÏßÄÏõê", phone: "010-4567-8901" },
                            { icon: "üö®", name: "ÏàôÏÜå Î¨∏Ïùò", phone: "031-329-9119" }
                        ]
                    },
                    'incheon': {
                        name: 'Ïù∏Ï≤ú SKÎ¨¥ÏùòÏó∞ÏàòÏõê',
                        address: 'Ïù∏Ï≤úÏãú Ï§ëÍµ¨ ÎåÄÎ¨¥ÏùòÎ°ú 159',
                        wifi: {
                            ssid: 'SK_Academy',
                            password: 'Î¨∏Ïùò Ïãú ÏïàÎÇ¥'
                        },
                        contacts: [
                            { icon: "üë®‚Äçüíº", name: "Ïö¥ÏòÅÏßÑ ÎåÄÌëú", phone: "032-750-8000" },
                            { icon: "üìã", name: "Î©òÌÜ† ÏßÄÏõê", phone: "032-750-8010" },
                            { icon: "üö®", name: "ÏùëÍ∏â Ïó∞ÎùΩÏ≤ò", phone: "032-750-8020" }
                        ]
                    }
                };
            }
        }

        // =====================================================
        // Î∂ÑÍ≥ºÎ≥Ñ Í∞ïÏùòÏû• Îç∞Ïù¥ÌÑ∞ (ÌïòÎìúÏΩîÎî© - Ï∂îÌõÑ Íµ¨Í∏ÄÏãúÌä∏ Ïó∞Îèô ÏòàÏ†ï)
        // =====================================================
        const facilityMapping = {
            icheon: {
                1: { lectureHall: 'Ï∞ΩÏ°∞Í¥Ä 401Ìò∏', teamRoom: 'Ï∞ΩÏ°∞Í¥Ä 401Ìò∏' },
                2: { lectureHall: 'Ï∞ΩÏ°∞Í¥Ä 401Ìò∏', teamRoom: 'Ï∞ΩÏ°∞Í¥Ä 403Ìò∏' },
                3: { lectureHall: 'Ï∞ΩÏ°∞Í¥Ä 401Ìò∏', teamRoom: 'Ï∞ΩÏ°∞Í¥Ä 404Ìò∏' },
                4: { lectureHall: 'Ï∞ΩÏ°∞Í¥Ä 301Ìò∏', teamRoom: 'Ï∞ΩÏ°∞Í¥Ä 407Ìò∏' },
                5: { lectureHall: 'Ï∞ΩÏ°∞Í¥Ä 301Ìò∏', teamRoom: 'Ï∞ΩÏ°∞Í¥Ä 301Ìò∏' },
                6: { lectureHall: 'Ï∞ΩÏ°∞Í¥Ä 301Ìò∏', teamRoom: 'Ï∞ΩÏ°∞Í¥Ä 305Ìò∏' },
                7: { lectureHall: 'Ï∞ΩÏ°∞Í¥Ä 201Ìò∏', teamRoom: 'Ï∞ΩÏ°∞Í¥Ä 307Ìò∏' },
                8: { lectureHall: 'Ï∞ΩÏ°∞Í¥Ä 201Ìò∏', teamRoom: 'Ï∞ΩÏ°∞Í¥Ä 308Ìò∏' },
                9: { lectureHall: 'Ï∞ΩÏ°∞Í¥Ä 201Ìò∏', teamRoom: 'Ï∞ΩÏ°∞Í¥Ä 201Ìò∏' },
                10: { lectureHall: 'Í≤ΩÏòÅÍ¥Ä 401Ìò∏', teamRoom: 'Ï∞ΩÏ°∞Í¥Ä 205Ìò∏' },
                11: { lectureHall: 'Í≤ΩÏòÅÍ¥Ä 401Ìò∏', teamRoom: 'Ï∞ΩÏ°∞Í¥Ä 210Ìò∏' },
                12: { lectureHall: 'Í≤ΩÏòÅÍ¥Ä 401Ìò∏', teamRoom: 'Í≤ΩÏòÅÍ¥Ä 401Ìò∏' },
                13: { lectureHall: 'Í≤ΩÏòÅÍ¥Ä 301Ìò∏', teamRoom: 'Í≤ΩÏòÅÍ¥Ä 301Ìò∏' },
                14: { lectureHall: 'Í≤ΩÏòÅÍ¥Ä 301Ìò∏', teamRoom: 'Ìå®Í∏∞Í¥Ä 107Ìò∏' },
                15: { lectureHall: 'Í≤ΩÏòÅÍ¥Ä 301Ìò∏', teamRoom: 'Ìå®Í∏∞Í¥Ä 108Ìò∏' }
            },
            yongin: {
                1: { lectureHall: 'Í≤ΩÏòÅÍ¥Ä 1F Vision Hall 1', teamRoom: 'Í≤ΩÏòÅÍ¥Ä 101Ìò∏' },
                2: { lectureHall: 'Í≤ΩÏòÅÍ¥Ä 1F Vision Hall 1', teamRoom: 'Í≤ΩÏòÅÍ¥Ä 102Ìò∏' },
                3: { lectureHall: 'Í≤ΩÏòÅÍ¥Ä 1F Vision Hall 1', teamRoom: 'Í≤ΩÏòÅÍ¥Ä 103Ìò∏' },
                4: { lectureHall: 'Í≤ΩÏòÅÍ¥Ä 2F Vision Hall 2', teamRoom: 'Í≤ΩÏòÅÍ¥Ä 104Ìò∏' },
                5: { lectureHall: 'Í≤ΩÏòÅÍ¥Ä 2F Vision Hall 2', teamRoom: 'Í≤ΩÏòÅÍ¥Ä 201Ìò∏' },
                6: { lectureHall: 'Í≤ΩÏòÅÍ¥Ä 2F Vision Hall 2', teamRoom: 'Í≤ΩÏòÅÍ¥Ä 202Ìò∏' },
                7: { lectureHall: 'Ïù∏Ïû¨Í¥Ä Future Hall', teamRoom: 'Í≤ΩÏòÅÍ¥Ä 203Ìò∏' },
                8: { lectureHall: 'Ïù∏Ïû¨Í¥Ä Future Hall', teamRoom: 'Í≤ΩÏòÅÍ¥Ä 204Ìò∏' },
                9: { lectureHall: 'Ïù∏Ïû¨Í¥Ä Future Hall', teamRoom: 'Ïù∏Ïû¨Í¥Ä 101Ìò∏' },
                10: { lectureHall: 'Ïù∏Ïû¨Í¥Ä Innovation Hall', teamRoom: 'Ïù∏Ïû¨Í¥Ä 102Ìò∏' },
                11: { lectureHall: 'Ïù∏Ïû¨Í¥Ä Innovation Hall', teamRoom: 'Ïù∏Ïû¨Í¥Ä 103Ìò∏' },
                12: { lectureHall: 'Ïù∏Ïû¨Í¥Ä Innovation Hall', teamRoom: 'Ïù∏Ïû¨Í¥Ä 104Ìò∏' },
                13: { lectureHall: 'Ïù∏Ïû¨Í¥Ä Challenge Hall', teamRoom: 'Ïù∏Ïû¨Í¥Ä 105Ìò∏' },
                14: { lectureHall: 'Ïù∏Ïû¨Í¥Ä Challenge Hall', teamRoom: 'Ïù∏Ïû¨Í¥Ä 106Ìò∏' },
                15: { lectureHall: 'Ïù∏Ïû¨Í¥Ä Challenge Hall', teamRoom: 'Ïù∏Ïû¨Í¥Ä Challenge Hall' }
            }
        };

        // =====================================================
        // ÌïòÎìúÏΩîÎî©Îêú Ìé∏ÏùòÏãúÏÑ§ Îç∞Ïù¥ÌÑ∞ (Í≥†Ï†ïÍ∞í)
        // =====================================================
        const staticAmenitiesData = {
            'icheon': {
                icon: 'üè¢',
                amenities: [
                    {
                        icon: "üèÉ‚Äç‚ôÇÔ∏è",
                        name: "Actium (Ï≤¥Ïú°Í¥Ä)",
                        info: "Ìå®Í∏∞Í¥Ä ÏßÄÌïò1Ï∏µ",
                        hours: "07:00~22:00",
                        note: "ÏùåÏãùÎ¨º Î∞òÏûÖ Î∞è Ï∑®Ïãù Í∏àÏßÄ"
                    },
                    {
                        icon: "üöø",
                        name: "ÏÇ¨Ïö∞ÎÇò",
                        info: "Ìå®Í∏∞Í¥Ä ÏßÄÌïò1Ï∏µ",
                        hours: "07:00~08:30, 18:00~22:00"
                    },
                    {
                        icon: "üëï",
                        name: "ÏÑ∏ÌÉÅÏã§",
                        info: "Ìå®Í∏∞Í¥Ä ÏßÄÌïò2Ï∏µ",
                        hours: "20:00 Ïù¥ÌõÑ Ïù¥Ïö© Í∞ÄÎä•",
                        note: "Ïã†ÏûÖÍµ¨ÏÑ±ÏõêÏùÄ Î¨∏ÏùòÏûêÏóê ÌïúÌï¥ ÏïàÎÇ¥"
                    },
                    {
                        icon: "üè™",
                        name: "ÌñâÎ≥µÎßàÌä∏(CU)",
                        info: "Ìå®Í∏∞Í¥Ä ÏßÄÌïò1Ï∏µ",
                        hours: "10:00~21:00"
                    },
                    {
                        icon: "üçΩÔ∏è",
                        name: "ÏãùÎãπ",
                        info: "Ìå®Í∏∞Í¥Ä ÏßÄÌïò1Ï∏µ",
                        hours: "Ï°∞Ïãù 07:30~08:30, Ï§ëÏãù 12:00~13:00, ÏÑùÏãù 18:00~19:00"
                    },
                    {
                        icon: "üìã",
                        name: "Ïö¥ÏòÅÏã§",
                        info: "Ìå®Í∏∞Í¥Ä 1Ï∏µ 106Ìò∏",
                        hours: "ÏÉÅÏãú Ïö¥ÏòÅ",
                        note: "105Ìò∏ Ïßê Î≥¥Í¥ÄÏû•ÏÜå ÏòÜ"
                    },
                    {
                        icon: "üõèÔ∏è",
                        name: "ÏàôÏÜå",
                        info: "Ìå®Í∏∞Í¥Ä 1~5Ï∏µ",
                        hours: "1ÏùºÏ∞® Ï¢ÖÎ£å ÌõÑ ÏûÖÏã§",
                        note: "ÌÉÄÏù∏ ÏàôÏÜå Ï†àÎåÄ Ï∂úÏûÖ Í∏àÏßÄ"
                    },
                    {
                        icon: "üì∂",
                        name: "Wi-Fi",
                        info: "Ïó∞ÏàòÏõê Ï†ÑÏ≤¥",
                        hours: "T_FMI Ïù¥Ïö©",
                        note: "ID: {WIFI_SSID} / PW: {WIFI_PASSWORD}" // ÎèôÏ†ÅÏúºÎ°ú ÍµêÏ≤¥Îê®
                    }
                ]
            },
            'yongin': {
                icon: 'üè´',
                amenities: [
                    {
                        icon: "üèÉ‚Äç‚ôÇÔ∏è",
                        name: "Ìó¨Ïä§Ïû•",
                        info: "ÌñâÎ≥µÍ¥Ä ÏßÄÌïò1Ï∏µ",
                        hours: "06:00~22:00"
                    },
                    {
                        icon: "üè™",
                        name: "Î¨¥Ïù∏Ìé∏ÏùòÏ†ê",
                        info: "ÌñâÎ≥µÍ¥Ä ÏßÄÌïò1Ï∏µ",
                        hours: "24ÏãúÍ∞Ñ Ïù¥Ïö© Í∞ÄÎä•"
                    },
                    {
                        icon: "üéÆ",
                        name: "ÎùºÏö¥ÏßÄ/Î≥¥ÎìúÍ≤åÏûÑ",
                        info: "ÌñâÎ≥µÍ¥Ä ÏßÄÌïò1Ï∏µ",
                        hours: "18:00~23:00"
                    },
                    {
                        icon: "üé≤",
                        name: "Î≥¥ÎìúÍ≤åÏûÑ ÎåÄÏó¨",
                        info: "Í≤ΩÏòÅÍ¥Ä 1Ï∏µ",
                        hours: "18:00~22:00",
                        note: "ÎåÄÏó¨Ïû•Î∂Ä Í∏∞ÏûÖ ÌõÑ Î∂ÑÍ≥ºÏû• ÎÇ¥ Ïù¥Ïö©"
                    },
                    {
                        icon: "üçΩÔ∏è",
                        name: "ÏãùÎãπ",
                        info: "Í≤ΩÏòÅÍ¥Ä 1Ï∏µ",
                        hours: "Ï°∞Ïãù 07:30~08:30, Ï§ëÏãù 12:00~13:00, ÏÑùÏãù 18:00~19:00"
                    },
                    {
                        icon: "üì∂",
                        name: "Wi-Fi",
                        info: "Ïó∞ÏàòÏõê Ï†ÑÏ≤¥",
                        hours: "SK_Academy",
                        note: "ID: {WIFI_SSID} / PW: {WIFI_PASSWORD}" // ÎèôÏ†ÅÏúºÎ°ú ÍµêÏ≤¥Îê®
                    }
                ]
            },
            'incheon': {
                icon: 'üåä',
                amenities: [
                    {
                        icon: "üåä",
                        name: "ÏûêÏó∞ÌôòÍ≤Ω",
                        info: "Î¨¥ÏùòÎèÑ ÏúÑÏπò",
                        hours: "24ÏãúÍ∞Ñ Ïù¥Ïö© Í∞ÄÎä•",
                        note: "ÏûêÏó∞ÏπúÌôîÏ†Å Ïó∞Ïàò ÌôòÍ≤Ω"
                    },
                    {
                        icon: "üçΩÔ∏è",
                        name: "ÏãùÎãπ",
                        info: "ÌñâÎ≥µÍ¥Ä",
                        hours: "Ï°∞Ïãù 7:30~8:30, Ï§ëÏãù 12:00~13:00, ÏÑùÏãù 18:00~19:00"
                    },
                    {
                        icon: "üì∂",
                        name: "Wi-Fi",
                        info: "Ïó∞ÏàòÏõê Ï†ÑÏ≤¥",
                        hours: "24ÏãúÍ∞Ñ Ïù¥Ïö©",
                        note: "ID: {WIFI_SSID} / PW: {WIFI_PASSWORD}" // ÎèôÏ†ÅÏúºÎ°ú ÍµêÏ≤¥Îê®
                    }
                ]
            }
        };

        // =====================================================
        // Ïú†Ìã∏Î¶¨Ìã∞ Ìï®ÏàòÎì§
        // =====================================================
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideInRight 0.3s ease reverse';
                setTimeout(() => {
                    if (document.body.contains(toast)) {
                        document.body.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }

        function getDataSourceBadge(source) {
            const badges = {
                'google': '<div class="data-source-badge source-google">‚úÖ ÏµúÏã† Îç∞Ïù¥ÌÑ∞</div>',
                'cache': '<div class="data-source-badge source-cache">üíæ Ï∫êÏãú Îç∞Ïù¥ÌÑ∞</div>',
                'default': '<div class="data-source-badge source-default">üìÑ Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞</div>'
            };
            return badges[source] || '';
        }

        function getSetupInfo() {
            const raw = localStorage.getItem('mentorSetup');
                if (!raw) return { trainingCenter: null, teamNumber: null };

                try {
                    const parsed = JSON.parse(raw);
                    return {
                    trainingCenter: parsed.trainingCenter?.toLowerCase(),
                    teamNumber: Number(parsed.teamNumber)
                    };
                } catch (e) {
                    return { trainingCenter: null, teamNumber: null };
            }
        }

        async function fetchFacilityMapping() {
            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbyvkEufshC8wwQwMqO5nJsdhhUC6EvBqKkeXVR5YF5cQnnPLUG3oo5d0eObTVkjN55Y/exec?action=getfacilityMapping');
                const json = await response.json();
                return json;
            } catch (error) {
                console.warn('‚ùå facilityMapping Î°úÎìú Ïã§Ìå®:', error);
                return null;
            }
        }



        // =====================================================
        // Î©îÏù∏ Î°úÎìú Ìï®Ïàò
        // =====================================================
        async function loadFacilityInfo() {
            const dataManager = new FacilityDataManager();
            const { trainingCenter: selectedCenter, teamNumber } = dataManager.getSetupInfo();

            console.log('üéØ ÏµúÏ¢Ö ÏÑ†ÌÉùÎêú Ïó∞ÏàòÏõê:', selectedCenter);
            console.log('üéØ ÏµúÏ¢Ö ÏÑ†ÌÉùÎêú Î∂ÑÍ≥º:', teamNumber);

            try {
                // Íµ¨Í∏ÄÏãúÌä∏ÏóêÏÑú Ïó∞ÏàòÏõê Í∏∞Î≥∏ Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞
                const { data: centersData, source } = await dataManager.getData();
                console.log(`üìä ÏÇ¨Ïö©Ìï† Ïó∞ÏàòÏõê Îç∞Ïù¥ÌÑ∞ (${source}):`, centersData);

                const centerData = centersData[selectedCenter];
                if (!centerData) {
                throw new Error(`Ïó∞ÏàòÏõê Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå: ${selectedCenter}`);
                }

                const staticData = staticAmenitiesData[selectedCenter];
                if (!staticData) {
                throw new Error(`Ìé∏ÏùòÏãúÏÑ§ Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå: ${selectedCenter}`);
                }

                // ‚úÖ Î∂ÑÍ≥º Ï†ïÎ≥¥ fetchÎäî Ï†ÑÏ≤¥ try Î∞ñÏóêÏÑú Í∞úÎ≥Ñ Ï≤òÎ¶¨
                let facilityMappingData = {};
                try {
                facilityMappingData = await dataManager.fetchFacilityMapping();
                } catch (e) {
                console.warn('‚ö†Ô∏è Î∂ÑÍ≥º Ï†ïÎ≥¥ Î°úÎìú Ïã§Ìå® (Î¨¥ÏãúÌïòÍ≥† Í≥ÑÏÜç ÏßÑÌñâ):', e);
                }

                // ‚úÖ Î∂ÑÍ≥º Ï†ïÎ≥¥Í∞Ä ÏóÜÏúºÎ©¥ fallback
                const teamInfo = facilityMappingData?.[selectedCenter]?.[teamNumber] ?? {
                lectureHall: 'Ïó∞ÏàòÏõê Ïó∞Í≤∞Ïù¥ ÏõêÌôúÌïòÏßÄ ÏïäÏäµÎãàÎã§',
                teamRoom: 'Ïó∞ÏàòÏõê Ïó∞Í≤∞Ïù¥ ÏõêÌôúÌïòÏßÄ ÏïäÏäµÎãàÎã§'
                };

                // ‚úÖ UI ÏóÖÎç∞Ïù¥Ìä∏Îäî Ìï≠ÏÉÅ Ïã§Ìñâ
                updateUI(centerData, staticData, teamInfo, selectedCenter, teamNumber, source);

                const messages = {
                'google': '‚úÖ ÏµúÏã† Îç∞Ïù¥ÌÑ∞Î°ú ÏóÖÎç∞Ïù¥Ìä∏ÎêòÏóàÏäµÎãàÎã§',
                'cache': 'üíæ Ï∫êÏãúÎêú Îç∞Ïù¥ÌÑ∞Î•º ÏÇ¨Ïö©Ìï©ÎãàÎã§',
                'default': 'üìÑ Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞Î•º ÏÇ¨Ïö©Ìï©ÎãàÎã§'
                };
                showToast(messages[source], source === 'google' ? 'success' : source === 'cache' ? 'warning' : 'info');

                console.log('‚úÖ Ïó∞ÏàòÏõê ÏãúÏÑ§ Ï†ïÎ≥¥ Î°úÎìú ÏôÑÎ£å:', selectedCenter, centerData.name);
            } catch (error) {
                console.error('‚ùå Ïó∞ÏàòÏõê Ï†ïÎ≥¥ Î°úÎìú Ïã§Ìå®:', error);
                showToast('‚ùå Îç∞Ïù¥ÌÑ∞ Î°úÎìúÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§', 'error');
                hideLoadingAndShowContent();
            }
        }


        function updateUI(centerData, staticData, teamInfo, selectedCenter, teamNumber, source) {
            // Î°úÎî© Ïà®Í∏∞Í≥† Ïª®ÌÖêÏ∏† ÌëúÏãú
            hideLoadingAndShowContent();
            
            // Wi-Fi Ï†ïÎ≥¥ ÎèôÏ†Å ÍµêÏ≤¥
            const amenitiesWithWifi = staticData.amenities.map(amenity => {
                if (amenity.icon === "üì∂") {
                    return {
                        ...amenity,
                        note: `ID: ${centerData.wifi.ssid} / PW: ${centerData.wifi.password}`
                    };
                }
                return amenity;
            });
            
            // Ïó∞ÏàòÏõê Ï†ïÎ≥¥ Ïπ¥Îìú ÏóÖÎç∞Ïù¥Ìä∏ (Î∂ÑÍ≥º Ï†ïÎ≥¥ Ìè¨Ìï®)
            const centerInfo = document.getElementById('center-info');
            centerInfo.innerHTML = `
                ${getDataSourceBadge(source)}
                <div class="center-icon">${staticData.icon}</div>
                <div class="center-name">${centerData.name}</div>
                <div class="center-address">${centerData.address}</div>
                <div style="margin-top: 16px; padding: 12px; background: rgba(234, 25, 23, 0.1); border-radius: 8px; border: 1px solid #ea1917;">
                    <div style="font-weight: 600; color: #ea1917; margin-bottom: 8px;">üìç ÌòÑÏû¨ ÏÑ§Ï†ï: ${centerData.name} ${teamNumber}Î∂ÑÍ≥º</div>
                    <div style="font-size: 14px; color: #666;">
                        <strong>Ï§ëÍ∞ïÏùòÏû•:</strong> ${teamInfo.lectureHall} | 
                        <strong>Î∂ÑÍ≥ºÏû•:</strong> ${teamInfo.teamRoom}
                    </div>
                </div>
            `;
            
            // Ìé∏ÏùòÏãúÏÑ§ ÏóÖÎç∞Ïù¥Ìä∏ (Wi-Fi Ï†ïÎ≥¥ Ìè¨Ìï®)
            const amenitiesGrid = document.getElementById('amenities-grid');
            amenitiesGrid.innerHTML = amenitiesWithWifi.map(amenity => `
                <div class="facility-item">
                    <div class="facility-icon">${amenity.icon}</div>
                    <div class="facility-content">
                        <div class="facility-name">${amenity.name}</div>
                        <div class="facility-info">${amenity.info}</div>
                        <div class="facility-hours">${amenity.hours}</div>
                        ${amenity.note ? `<div class="facility-note">üí° ${amenity.note}</div>` : ''}
                    </div>
                </div>
            `).join('');
            
            // Ïó∞ÎùΩÏ≤ò ÏóÖÎç∞Ïù¥Ìä∏ (Íµ¨Í∏ÄÏãúÌä∏ÏóêÏÑú Ïò® ÎèôÏ†Å Îç∞Ïù¥ÌÑ∞)
            const contactList = document.getElementById('contact-list');
            contactList.innerHTML = centerData.contacts.map(contact => `
                <div class="contact-item">
                    <div class="contact-icon">${contact.icon}</div>
                    <div class="contact-details">
                        <div class="contact-name">${contact.name}</div>
                        <div class="contact-phone">${contact.phone}</div>
                    </div>
                </div>
            `).join('');
            
            // Îßµ Ïª®ÌÖåÏù¥ÎÑà ÏóÖÎç∞Ïù¥Ìä∏ (Ïù¥ÎØ∏ÏßÄ Ìè¨Ìï®)
            const mapContainer = document.querySelector('.map-container');
            if (selectedCenter === 'icheon' || selectedCenter === 'yongin') {
                mapContainer.innerHTML = `
                    <img src="../assets/images/map-${selectedCenter}.png" 
                        alt="${centerData.name} Í±¥Î¨º Î∞∞ÏπòÎèÑ">
                    <div class="map-highlight">ÎÇ¥ Ï£ºÏöî ÌôúÎèô ÏúÑÏπò: ${teamInfo.teamRoom}</div>
                `;
            } else {
                mapContainer.innerHTML = `
                    <div class="map-placeholder">
                        üìç Ïó∞ÏàòÏõê Í±¥Î¨º Î∞∞ÏπòÎèÑ
                        <div style="font-size: 0.9em; margin-top: 8px; opacity: 0.7;">
                            (Ï§ÄÎπÑ Ï§ë)
                        </div>
                    </div>
                    <div class="map-highlight">ÎÇ¥ Ï£ºÏöî ÌôúÎèô ÏúÑÏπò: ${teamInfo.teamRoom}</div>
                `;
            }
        }

        function hideLoadingAndShowContent() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('center-info').style.display = 'block';
            document.getElementById('map-section').style.display = 'block';
            document.getElementById('amenities-section').style.display = 'block';
            document.getElementById('contact-section').style.display = 'block';
        }

        // =====================================================
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ïã§Ìñâ
        // =====================================================
        document.addEventListener('DOMContentLoaded', async function() {
            // Ïó∞ÏàòÏõê Ï†ïÎ≥¥ Î°úÎìú
            await loadFacilityInfo();
            
            // Ïï†ÎãàÎ©îÏù¥ÏÖò
            const sections = document.querySelectorAll('.info-section, .center-info-card');
            sections.forEach((section, index) => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(30px)';
                
                setTimeout(() => {
                    section.style.transition = 'all 0.6s ease';
                    section.style.opacity = '1';
                    section.style.transform = 'translateY(0)';
                }, index * 150);
            });
        });
    </script>
</body>
</html>
